import { useState, useCallback } from ‘react’;

const CONFIG = {
starCount: 100,
launchDuration: 3000,
earthRotationDuration: 90
};

const generateStars = (count) => {
return Array.from({ length: count }, (_, i) => ({
id: i,
left: Math.random() * 100,
top: Math.random() * 75,
size: Math.random() * 2.5 + 0.5,
delay: Math.random() * 4,
duration: Math.random() * 2 + 1.5,
brightness: Math.random() * 0.6 + 0.4
}));
};

const RealisticEarth = () => (

  <div style={{
    position: 'absolute',
    bottom: '-220px',
    left: '50%',
    transform: 'translateX(-50%)',
    width: '550px',
    height: '550px',
  }}>
    {/* 大気グロー外側 */}
    <div style={{
      position: 'absolute',
      inset: '-50px',
      borderRadius: '50%',
      background: 'radial-gradient(circle, transparent 45%, rgba(100, 180, 255, 0.08) 65%, rgba(120, 200, 255, 0.12) 80%, transparent 95%)',
      animation: 'atmospherePulse 6s ease-in-out infinite',
    }} />
    {/* 大気グロー内側 */}
    <div style={{
      position: 'absolute',
      inset: '-25px',
      borderRadius: '50%',
      background: 'radial-gradient(circle, transparent 60%, rgba(135, 206, 250, 0.15) 75%, rgba(100, 180, 255, 0.25) 90%, transparent 100%)',
    }} />
    {/* 地球本体 */}
    <div style={{
      position: 'absolute',
      inset: 0,
      borderRadius: '50%',
      overflow: 'hidden',
      boxShadow: 'inset -50px -30px 100px rgba(0,0,0,0.7), inset 40px 30px 80px rgba(255,255,255,0.05), 0 0 60px 10px rgba(100,180,255,0.3), 0 0 120px 30px rgba(80,160,255,0.15)'
    }}>
      {/* 海のベース */}
      <div style={{
        position: 'absolute',
        inset: 0,
        background: 'radial-gradient(circle at 30% 30%, #1a6baa 0%, #0f4c75 40%, #0a3d62 70%, #072a45 100%)'
      }} />

```
  {/* 大陸SVG - 詳細な北米大陸を含む */}
  <svg viewBox="0 0 400 400" style={{
    position: 'absolute',
    inset: 0,
    width: '100%',
    height: '100%',
    animation: `earthSpin ${CONFIG.earthRotationDuration}s linear infinite`
  }}>
    <defs>
      <linearGradient id="landGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stopColor="#5cb85c"/>
        <stop offset="30%" stopColor="#4a9c4a"/>
        <stop offset="60%" stopColor="#3d8b3d"/>
        <stop offset="100%" stopColor="#2d6b2d"/>
      </linearGradient>
      <linearGradient id="land2" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stopColor="#5aac5a"/>
        <stop offset="100%" stopColor="#3a8a3a"/>
      </linearGradient>
      <linearGradient id="mountainGradient" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" stopColor="#8B7355"/>
        <stop offset="50%" stopColor="#6B5344"/>
        <stop offset="100%" stopColor="#4a3728"/>
      </linearGradient>
      <linearGradient id="desertGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stopColor="#D4B896"/>
        <stop offset="100%" stopColor="#C4A070"/>
      </linearGradient>
      <linearGradient id="iceGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stopColor="#FFFFFF"/>
        <stop offset="100%" stopColor="#E8E8F0"/>
      </linearGradient>
      <filter id="landShadow" x="-10%" y="-10%" width="120%" height="120%">
        <feDropShadow dx="1" dy="1" stdDeviation="2" floodColor="#000" floodOpacity="0.3"/>
      </filter>
    </defs>
    
    <g filter="url(#landShadow)">
      {/* ===== 北米大陸 ===== */}
      {/* アラスカ */}
      <path d="M25,95 Q18,88 22,78 Q32,70 48,74 Q58,70 65,78 Q70,86 66,94 Q72,98 68,106 Q60,112 50,108 Q40,112 32,108 Q24,104 25,95 Z" fill="url(#landGradient)"/>
      <ellipse cx="45" cy="88" rx="10" ry="5" fill="url(#mountainGradient)" opacity="0.6"/>
      
      {/* カナダ */}
      <path d="M75,75 Q90,68 120,65 Q150,62 175,66 Q195,64 210,70 Q222,76 218,88 Q212,96 200,100 Q185,106 165,108 Q145,112 125,110 Q105,112 88,106 Q75,100 72,88 Q70,78 75,75 Z" fill="url(#landGradient)"/>
      {/* カナダ北部の島々 */}
      <ellipse cx="150" cy="55" rx="18" ry="7" fill="url(#iceGradient)" opacity="0.9"/>
      <ellipse cx="175" cy="52" rx="12" ry="5" fill="url(#iceGradient)" opacity="0.85"/>
      <ellipse cx="195" cy="58" rx="14" ry="5" fill="url(#iceGradient)" opacity="0.8"/>
      
      {/* アメリカ本土 */}
      <path d="M80,108 Q95,104 115,107 Q140,105 165,108 Q190,106 210,110 Q228,115 235,125 Q240,135 236,148 Q230,160 218,168 Q205,176 188,180 Q168,185 148,183 Q125,186 105,180 Q88,175 78,165 Q68,155 70,140 Q68,125 75,115 Q78,110 80,108 Z" fill="url(#landGradient)"/>
      
      {/* フロリダ半島 */}
      <path d="M205,172 Q212,176 215,188 Q218,205 212,220 Q206,228 200,224 Q196,210 198,195 Q196,180 202,174 Z" fill="url(#landGradient)"/>
      
      {/* ロッキー山脈 */}
      <path d="M90,115 Q98,112 105,120 Q110,135 105,152 Q100,165 92,168 Q84,164 82,150 Q80,132 85,118 Z" fill="url(#mountainGradient)" opacity="0.7"/>
      
      {/* アパラチア山脈 */}
      <path d="M195,128 Q202,124 208,132 Q212,145 208,162 Q202,172 195,168 Q190,155 192,140 Z" fill="url(#mountainGradient)" opacity="0.5"/>
      
      {/* 南西部砂漠 */}
      <ellipse cx="100" cy="168" rx="18" ry="9" fill="url(#desertGradient)" opacity="0.7"/>
      
      {/* 五大湖 */}
      <ellipse cx="178" cy="118" rx="6" ry="4" fill="#2a6a9a"/>
      <ellipse cx="188" cy="116" rx="4" ry="3" fill="#2a6a9a"/>
      <ellipse cx="172" cy="122" rx="4" ry="2.5" fill="#2a6a9a"/>
      <ellipse cx="165" cy="120" rx="3" ry="2" fill="#2a6a9a"/>
      
      {/* メキシコ */}
      <path d="M72,182 Q88,175 110,178 Q132,175 150,182 Q165,188 170,200 Q175,218 168,235 Q155,252 135,260 Q110,265 90,255 Q72,245 65,228 Q58,210 62,195 Q68,185 72,182 Z" fill="url(#landGradient)"/>
      
      {/* バハ・カリフォルニア半島 */}
      <path d="M58,198 Q52,208 48,225 Q45,242 50,255 Q56,260 60,252 Q65,235 62,218 Q65,205 58,198 Z" fill="url(#landGradient)"/>
      
      {/* メキシコ砂漠 */}
      <ellipse cx="95" cy="210" rx="15" ry="12" fill="url(#desertGradient)" opacity="0.6"/>
      
      {/* 中央アメリカ */}
      <path d="M138,262 Q152,258 165,266 Q172,278 168,292 Q160,305 145,308 Q128,306 120,292 Q116,276 125,265 Q130,260 138,262 Z" fill="url(#landGradient)"/>
      
      {/* キューバ */}
      <path d="M200,238 Q218,234 238,238 Q250,242 254,250 Q250,256 235,258 Q218,260 205,255 Q195,250 200,238 Z" fill="url(#landGradient)"/>
      
      {/* ===== 南米大陸 ===== */}
      <path d="M155,315 Q175,308 192,318 Q205,335 200,360 Q192,385 175,400 Q155,410 138,402 Q125,390 122,365 Q120,340 132,322 Q142,312 155,315 Z" fill="url(#landGradient)"/>
      {/* アンデス山脈 */}
      <path d="M130,330 Q138,325 142,340 Q145,365 140,390 Q135,400 128,395 Q122,380 125,355 Q124,335 130,330 Z" fill="url(#mountainGradient)" opacity="0.6"/>
      {/* アマゾン */}
      <ellipse cx="165" cy="355" rx="18" ry="22" fill="#1b5e20" opacity="0.5"/>
      
      {/* ===== ヨーロッパ ===== */}
      <path d="M270,80 Q285,75 300,80 Q312,88 310,100 Q305,110 292,112 Q278,115 268,108 Q260,98 265,88 Q268,82 270,80 Z" fill="url(#landGradient)"/>
      {/* イギリス */}
      <ellipse cx="258" cy="82" rx="6" ry="8" fill="url(#landGradient)"/>
      {/* スカンジナビア */}
      <path d="M290,62 Q298,55 305,60 Q310,72 305,85 Q298,90 292,82 Q288,70 290,62 Z" fill="url(#landGradient)"/>
      
      {/* ===== アフリカ ===== */}
      <path d="M275,125 Q295,120 312,130 Q325,145 322,170 Q318,198 302,218 Q282,235 262,230 Q245,220 242,195 Q240,165 250,142 Q260,128 275,125 Z" fill="url(#landGradient)"/>
      {/* サハラ砂漠 */}
      <ellipse cx="282" cy="148" rx="22" ry="14" fill="url(#desertGradient)" opacity="0.8"/>
      {/* マダガスカル */}
      <ellipse cx="330" cy="210" rx="6" ry="12" fill="url(#landGradient)"/>
      
      {/* ===== アジア ===== */}
      <path d="M320,65 Q350,58 380,68 Q400,80 398,100 Q395,122 380,135 Q360,148 335,145 Q315,142 308,125 Q302,105 310,85 Q315,72 320,65 Z" fill="url(#landGradient)"/>
      {/* ヒマラヤ */}
      <path d="M355,105 Q365,100 375,108 Q378,118 372,128 Q362,132 355,125 Q350,115 355,105 Z" fill="url(#mountainGradient)" opacity="0.7"/>
      {/* インド */}
      <path d="M340,145 Q352,142 360,152 Q365,168 358,185 Q348,195 338,188 Q330,175 332,160 Q335,148 340,145 Z" fill="url(#landGradient)"/>
      {/* 東南アジア */}
      <path d="M375,145 Q385,142 392,150 Q395,162 388,175 Q378,182 372,172 Q368,158 375,145 Z" fill="url(#landGradient)"/>
      
      {/* 日本 */}
      <path d="M398,88 Q402,82 406,88 Q408,98 405,108 Q400,115 396,108 Q394,98 398,88 Z" fill="url(#land2)"/>
      
      {/* ===== オーストラリア ===== */}
      <path d="M365,220 Q385,215 400,225 Q412,240 408,260 Q398,278 378,282 Q358,280 350,265 Q345,248 355,232 Q360,222 365,220 Z" fill="url(#landGradient)"/>
      {/* オーストラリア内陸砂漠 */}
      <ellipse cx="380" cy="252" rx="15" ry="12" fill="url(#desertGradient)" opacity="0.7"/>
      {/* ニュージーランド */}
      <ellipse cx="420" cy="295" rx="5" ry="10" fill="url(#landGradient)"/>
      
      {/* ===== 極地 ===== */}
      {/* 北極 */}
      <ellipse cx="200" cy="25" rx="80" ry="18" fill="url(#iceGradient)" opacity="0.85"/>
      {/* 南極 */}
      <ellipse cx="200" cy="385" rx="90" ry="20" fill="url(#iceGradient)" opacity="0.9"/>
    </g>
  </svg>
  
  {/* 雲レイヤー */}
  <svg viewBox="0 0 400 400" style={{
    position: 'absolute',
    inset: 0,
    width: '100%',
    height: '100%',
    animation: `cloudSpin ${CONFIG.earthRotationDuration * 1.3}s linear infinite`
  }}>
    <defs>
      <filter id="cloudBlur"><feGaussianBlur stdDeviation="3"/></filter>
    </defs>
    <ellipse cx="80" cy="100" rx="30" ry="10" fill="white" opacity="0.45" filter="url(#cloudBlur)"/>
    <ellipse cx="200" cy="80" rx="35" ry="12" fill="white" opacity="0.4" filter="url(#cloudBlur)"/>
    <ellipse cx="320" cy="95" rx="28" ry="10" fill="white" opacity="0.42" filter="url(#cloudBlur)"/>
    <ellipse cx="150" cy="160" rx="25" ry="9" fill="white" opacity="0.38" filter="url(#cloudBlur)"/>
    <ellipse cx="280" cy="180" rx="32" ry="11" fill="white" opacity="0.4" filter="url(#cloudBlur)"/>
    <ellipse cx="100" cy="250" rx="28" ry="10" fill="white" opacity="0.35" filter="url(#cloudBlur)"/>
    <ellipse cx="350" cy="240" rx="30" ry="10" fill="white" opacity="0.4" filter="url(#cloudBlur)"/>
    <ellipse cx="220" cy="300" rx="25" ry="8" fill="white" opacity="0.35" filter="url(#cloudBlur)"/>
  </svg>
  
  {/* 光源ハイライト */}
  <div style={{
    position: 'absolute',
    inset: 0,
    borderRadius: '50%',
    background: 'radial-gradient(ellipse at 25% 25%, rgba(255,255,255,0.18) 0%, transparent 50%)',
  }} />
  {/* ターミネーター */}
  <div style={{
    position: 'absolute',
    inset: 0,
    borderRadius: '50%',
    background: 'linear-gradient(105deg, transparent 0%, transparent 45%, rgba(0,0,20,0.25) 55%, rgba(0,0,30,0.55) 70%, rgba(0,0,10,0.8) 100%)',
  }} />
  {/* 大気リムライト */}
  <div style={{
    position: 'absolute',
    inset: 0,
    borderRadius: '50%',
    background: 'radial-gradient(circle, transparent 75%, rgba(135,206,250,0.25) 90%, rgba(100,180,255,0.5) 96%, rgba(80,160,255,0.7) 100%)',
  }} />
</div>
```

  </div>
);

const RealisticRocket = ({ isLaunching }) => (

  <div style={{
    position: 'absolute',
    bottom: isLaunching ? '130%' : '310px',
    left: '50%',
    transform: 'translateX(-50%)',
    width: '50px',
    height: '150px',
    transition: isLaunching ? `bottom ${CONFIG.launchDuration}ms cubic-bezier(0.15, 0, 0.3, 1)` : `bottom ${CONFIG.launchDuration * 1.2}ms cubic-bezier(0.4, 0, 0.6, 1)`,
    zIndex: 10,
    animation: isLaunching ? 'rocketShake 0.06s ease-in-out infinite' : 'none'
  }}>
    <svg viewBox="0 0 70 240" style={{ width: '100%', height: '100%', filter: 'drop-shadow(0 15px 50px rgba(0,0,0,0.7))' }}>
      <defs>
        <linearGradient id="rocketBody" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" stopColor="#8a8a8a" />
          <stop offset="15%" stopColor="#c8c8c8" />
          <stop offset="50%" stopColor="#f8f8f8" />
          <stop offset="85%" stopColor="#c8c8c8" />
          <stop offset="100%" stopColor="#8a8a8a" />
        </linearGradient>
        <linearGradient id="noseCone" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" stopColor="#1a1a1a" />
          <stop offset="50%" stopColor="#444" />
          <stop offset="100%" stopColor="#1a1a1a" />
        </linearGradient>
        <linearGradient id="interstage" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" stopColor="#202020" />
          <stop offset="50%" stopColor="#505050" />
          <stop offset="100%" stopColor="#202020" />
        </linearGradient>
        <linearGradient id="flameOuter" x1="0%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" stopColor="#ff3300" />
          <stop offset="30%" stopColor="#ff7700" />
          <stop offset="60%" stopColor="#ffbb00" />
          <stop offset="100%" stopColor="rgba(255,255,0,0)" />
        </linearGradient>
        <linearGradient id="flameMid" x1="0%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" stopColor="#ffcc00" />
          <stop offset="100%" stopColor="rgba(255,255,200,0)" />
        </linearGradient>
        <linearGradient id="flameCore" x1="0%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" stopColor="#fff" />
          <stop offset="100%" stopColor="rgba(255,255,255,0)" />
        </linearGradient>
        <filter id="flameGlow" x="-100%" y="-20%" width="300%" height="150%">
          <feGaussianBlur in="SourceGraphic" stdDeviation="3" />
        </filter>
      </defs>
      <path d="M35,0 C25,15 22,35 22,50 L48,50 C48,35 45,15 35,0 Z" fill="url(#noseCone)" />
      <rect x="22" y="50" width="26" height="40" fill="url(#rocketBody)" />
      <rect x="20" y="90" width="30" height="12" fill="url(#interstage)" />
      <rect x="20" y="102" width="30" height="90" fill="url(#rocketBody)" />
      <rect x="24" y="130" width="22" height="25" fill="none" stroke="#1565c0" strokeWidth="0.6" rx="1.5" />
      <text x="35" y="145" textAnchor="middle" fill="#1565c0" fontSize="5" fontWeight="bold">SPACE</text>
      <rect x="6" y="105" width="12" height="18" fill="url(#interstage)" rx="1" />
      <rect x="52" y="105" width="12" height="18" fill="url(#interstage)" rx="1" />
      <path d="M20,175 L5,198 L9,200 L22,180" fill="url(#interstage)" />
      <path d="M50,175 L65,198 L61,200 L48,180" fill="url(#interstage)" />
      <path d="M20,192 L17,202 L53,202 L50,192" fill="url(#interstage)" />
      <ellipse cx="35" cy="206" rx="5.5" ry="2.5" fill="#111" />
      {isLaunching && (
        <g style={{ animation: 'flameFlicker 0.08s ease-in-out infinite' }}>
          <ellipse cx="35" cy="260" rx="40" ry="55" fill="url(#flameOuter)" filter="url(#flameGlow)" opacity="0.5" />
          <path d="M20,208 Q12,240 10,280 Q22,320 35,330 Q48,320 60,280 Q58,240 50,208 Z" fill="url(#flameOuter)" filter="url(#flameGlow)" />
          <path d="M26,208 Q22,235 20,265 Q28,300 35,310 Q42,300 50,265 Q48,235 44,208 Z" fill="url(#flameMid)" />
          <path d="M32,208 Q30,230 29,255 Q32,280 35,290 Q38,280 41,255 Q40,230 38,208 Z" fill="url(#flameCore)" />
        </g>
      )}
    </svg>
  </div>
);

const LaunchSmoke = ({ isLaunching }) => (

  <div style={{
    position: 'absolute',
    bottom: '280px',
    left: '50%',
    transform: 'translateX(-50%)',
    width: '300px',
    height: '150px',
    opacity: isLaunching ? 1 : 0,
    transition: 'opacity 0.3s ease',
    pointerEvents: 'none'
  }}>
    {[...Array(10)].map((_, i) => (
      <div key={i} style={{
        position: 'absolute',
        bottom: `${(i % 4) * 12}px`,
        left: `${15 + (i % 5) * 14}%`,
        width: `${60 + i * 10}px`,
        height: `${40 + i * 6}px`,
        backgroundColor: `rgba(${200 - i * 5}, ${195 - i * 5}, ${190 - i * 5}, ${0.8 - i * 0.05})`,
        borderRadius: '50%',
        filter: 'blur(15px)',
        animation: isLaunching ? `smokePuff ${1 + i * 0.12}s ease-out infinite` : 'none',
        animationDelay: `${i * 0.06}s`
      }} />
    ))}
  </div>
);

export default function RocketLaunch() {
const [isLaunching, setIsLaunching] = useState(false);
const [launchCount, setLaunchCount] = useState(0);
const [stars] = useState(() => generateStars(CONFIG.starCount));

const handleClick = useCallback(() => {
if (!isLaunching) {
// 1回目のタップ：発射
setIsLaunching(true);
setLaunchCount(prev => prev + 1);
} else {
// 2回目のタップ：帰還
setIsLaunching(false);
}
}, [isLaunching]);

return (
<>
<style>{`@keyframes twinkle { 0%, 100% { opacity: 1; } 50% { opacity: 0.2; } } @keyframes earthSpin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } @keyframes cloudSpin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } @keyframes atmospherePulse { 0%, 100% { opacity: 0.8; } 50% { opacity: 1; } } @keyframes flameFlicker { 0%, 100% { transform: scaleY(1) scaleX(1); } 50% { transform: scaleY(1.05) scaleX(0.95); } } @keyframes smokePuff { 0% { transform: scale(1) translateY(0); opacity: 0.8; } 100% { transform: scale(4) translateY(-100px); opacity: 0; } } @keyframes rocketShake { 0%, 100% { transform: translateX(-50%); } 50% { transform: translateX(-50%) translateY(-2px) rotate(0.3deg); } }`}</style>
<div onClick={handleClick} style={{
position: ‘relative’,
width: ‘100%’,
height: ‘100vh’,
overflow: ‘hidden’,
cursor: ‘pointer’,
fontFamily: ‘system-ui, sans-serif’,
background: ‘linear-gradient(180deg, #000005 0%, #020208 40%, #03030f 70%, #050515 100%)’
}}>
<div style={{
position: ‘absolute’,
top: ‘5%’,
left: ‘-30%’,
width: ‘160%’,
height: ‘35%’,
background: ‘linear-gradient(115deg, transparent 0%, rgba(120,100,150,0.06) 40%, rgba(150,120,180,0.08) 50%, rgba(120,100,150,0.06) 60%, transparent 100%)’,
transform: ‘rotate(-25deg)’,
filter: ‘blur(25px)’,
}} />
{stars.map(star => (
<div key={star.id} style={{
position: ‘absolute’,
left: `${star.left}%`,
top: `${star.top}%`,
width: `${star.size}px`,
height: `${star.size}px`,
backgroundColor: `rgba(255,255,255,${star.brightness})`,
borderRadius: ‘50%’,
boxShadow: star.size > 2 ? `0 0 ${star.size * 3}px ${star.size}px rgba(200,220,255,${star.brightness * 0.4})` : ‘none’,
animation: `twinkle ${star.duration}s ease-in-out ${star.delay}s infinite`
}} />
))}
<LaunchSmoke isLaunching={isLaunching} />
<RealisticRocket isLaunching={isLaunching} />
<RealisticEarth />
<div style={{ position: ‘absolute’, bottom: ‘30px’, left: ‘50%’, transform: ‘translateX(-50%)’, textAlign: ‘center’, zIndex: 20 }}>
<div style={{ color: ‘#fff’, fontSize: ‘12px’, letterSpacing: ‘4px’, textTransform: ‘uppercase’, marginBottom: ‘12px’, textShadow: ‘0 0 25px rgba(100,180,255,0.9)’ }}>
Space Launch Simulator
</div>
<div style={{ color: ‘#5cb8ff’, fontSize: ‘10px’, letterSpacing: ‘2px’, marginBottom: ‘6px’ }}>
LAUNCHES: {launchCount}
</div>
<div style={{ color: ‘rgba(255,255,255,0.45)’, fontSize: ‘9px’, letterSpacing: ‘1px’ }}>
{isLaunching ? ‘Click to return’ : ‘Click to launch’}
</div>
</div>
</div>
</>
);
}