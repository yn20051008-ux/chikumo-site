<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>五式 ― 因・理・縁・衡・循</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@300;400;500;600;700&family=Shippori+Mincho:wght@400;500;600;700&family=Zen+Kaku+Gothic+New:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-bg: #faf9f7;
            --color-bg-alt: #f5f3ef;
            --color-text: #1a1a1a;
            --color-text-muted: #6b6b6b;
            --color-accent: #8b4513;
            --color-accent-light: #d4a574;
            --color-border: #e0dcd4;
            --color-highlight: rgba(139, 69, 19, 0.08);
            --font-display: 'Shippori Mincho', serif;
            --font-body: 'Noto Serif JP', serif;
            --font-ui: 'Zen Kaku Gothic New', sans-serif;
            --transition-smooth: cubic-bezier(0.25, 0.46, 0.45, 0.94);
            --shadow-soft: 0 4px 30px rgba(0, 0, 0, 0.04);
            --shadow-medium: 0 8px 40px rgba(0, 0, 0, 0.08);
        }

        [data-theme="dark"] {
            --color-bg: #0f0f0f;
            --color-bg-alt: #1a1a1a;
            --color-text: #e8e6e1;
            --color-text-muted: #8a8a8a;
            --color-accent: #d4a574;
            --color-accent-light: #8b4513;
            --color-border: #2a2a2a;
            --color-highlight: rgba(212, 165, 116, 0.1);
            --shadow-soft: 0 4px 30px rgba(0, 0, 0, 0.3);
            --shadow-medium: 0 8px 40px rgba(0, 0, 0, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }

        body {
            font-family: var(--font-body);
            background: var(--color-bg);
            color: var(--color-text);
            line-height: 1.9;
            letter-spacing: 0.02em;
            transition: background 0.5s var(--transition-smooth), color 0.5s var(--transition-smooth);
            overflow-x: hidden;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--color-bg);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--color-border);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--color-accent);
        }

        /* Selection */
        ::selection {
            background: var(--color-accent);
            color: #fff;
        }

        /* ========== HEADER ========== */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: transparent;
            transition: all 0.4s var(--transition-smooth);
        }

        .header.scrolled {
            background: var(--color-bg);
            box-shadow: var(--shadow-soft);
            padding: 0.75rem 2rem;
        }

        .header-logo {
            font-family: var(--font-display);
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--color-text);
            text-decoration: none;
            letter-spacing: 0.3em;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .theme-toggle {
            width: 44px;
            height: 44px;
            border: 1px solid var(--color-border);
            border-radius: 50%;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s var(--transition-smooth);
        }

        .theme-toggle:hover {
            border-color: var(--color-accent);
            transform: rotate(180deg);
        }

        .theme-toggle svg {
            width: 20px;
            height: 20px;
            fill: var(--color-text);
            transition: fill 0.3s;
        }

        .sun-icon { display: none; }
        [data-theme="dark"] .sun-icon { display: block; }
        [data-theme="dark"] .moon-icon { display: none; }

        /* ========== SIDE NAVIGATION ========== */
        .side-nav {
            position: fixed;
            left: 2rem;
            top: 50%;
            transform: translateY(-50%);
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .side-nav-item {
            width: 12px;
            height: 12px;
            border: 1px solid var(--color-border);
            border-radius: 50%;
            background: transparent;
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            position: relative;
        }

        .side-nav-item::after {
            content: attr(data-label);
            position: absolute;
            left: 24px;
            top: 50%;
            transform: translateY(-50%);
            font-family: var(--font-ui);
            font-size: 0.7rem;
            color: var(--color-text-muted);
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .side-nav-item:hover::after,
        .side-nav-item.active::after {
            opacity: 1;
        }

        .side-nav-item:hover,
        .side-nav-item.active {
            background: var(--color-accent);
            border-color: var(--color-accent);
            transform: scale(1.3);
        }

        /* ========== HERO ========== */
        .hero {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            padding: 2rem;
            overflow: hidden;
        }

        .hero-bg {
            position: absolute;
            inset: 0;
            opacity: 0.03;
            background: 
                radial-gradient(circle at 20% 30%, var(--color-accent) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, var(--color-accent-light) 0%, transparent 50%);
        }

        .hero-vertical {
            position: absolute;
            right: 4rem;
            top: 50%;
            transform: translateY(-50%);
            writing-mode: vertical-rl;
            font-family: var(--font-display);
            font-size: 0.85rem;
            letter-spacing: 0.5em;
            color: var(--color-text-muted);
            opacity: 0;
            animation: fadeSlideIn 1s var(--transition-smooth) 1.5s forwards;
        }

        .hero-content {
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .hero-kanji {
            font-family: var(--font-display);
            font-size: clamp(4rem, 15vw, 12rem);
            font-weight: 400;
            letter-spacing: 0.2em;
            margin-bottom: 2rem;
            opacity: 0;
            animation: fadeScaleIn 1.2s var(--transition-smooth) 0.3s forwards;
        }

        .hero-kanji span {
            display: inline-block;
            transition: all 0.5s var(--transition-smooth);
            cursor: default;
        }

        .hero-subtitle {
            font-family: var(--font-ui);
            font-size: 0.9rem;
            font-weight: 300;
            letter-spacing: 0.5em;
            color: var(--color-text-muted);
            margin-bottom: 1rem;
            opacity: 0;
            animation: fadeSlideIn 1s var(--transition-smooth) 0.8s forwards;
        }

        .hero-tagline {
            font-family: var(--font-display);
            font-size: 1.1rem;
            font-weight: 400;
            color: var(--color-text);
            max-width: 600px;
            margin: 0 auto;
            opacity: 0;
            animation: fadeSlideIn 1s var(--transition-smooth) 1.1s forwards;
        }

        .hero-scroll {
            position: absolute;
            bottom: 3rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            opacity: 0;
            animation: fadeSlideIn 1s var(--transition-smooth) 1.8s forwards;
        }

        .hero-scroll span {
            font-family: var(--font-ui);
            font-size: 0.7rem;
            letter-spacing: 0.2em;
            color: var(--color-text-muted);
        }

        .hero-scroll-line {
            width: 1px;
            height: 60px;
            background: linear-gradient(to bottom, var(--color-accent), transparent);
            animation: scrollPulse 2s ease-in-out infinite;
        }

        @keyframes fadeScaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes fadeSlideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes scrollPulse {
            0%, 100% { opacity: 0.3; transform: scaleY(1); }
            50% { opacity: 1; transform: scaleY(1.2); }
        }

        /* ========== MAIN CONTENT ========== */
        .main {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* ========== SECTIONS ========== */
        .section {
            padding: 8rem 0;
            opacity: 0;
            transform: translateY(40px);
            transition: all 0.8s var(--transition-smooth);
        }

        .section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .section-header {
            margin-bottom: 4rem;
            position: relative;
        }

        .section-number {
            font-family: var(--font-ui);
            font-size: 0.75rem;
            font-weight: 300;
            letter-spacing: 0.3em;
            color: var(--color-accent);
            margin-bottom: 1rem;
            display: block;
        }

        .section-title {
            font-family: var(--font-display);
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            font-weight: 500;
            letter-spacing: 0.1em;
            position: relative;
            display: inline-block;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -1rem;
            left: 0;
            width: 3rem;
            height: 2px;
            background: var(--color-accent);
        }

        .section-lead {
            font-size: 1.1rem;
            line-height: 2.2;
            color: var(--color-text-muted);
            margin-top: 2rem;
            max-width: 700px;
        }

        /* ========== GOSHIKI DIAGRAM ========== */
        .goshiki-diagram {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 4rem 0;
            position: relative;
        }

        .diagram-container {
            position: relative;
            width: 320px;
            height: 320px;
        }

        .diagram-element {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.4s var(--transition-smooth);
        }

        .diagram-kanji {
            font-family: var(--font-display);
            font-size: 2.5rem;
            font-weight: 500;
            transition: color 0.3s;
        }

        .diagram-label {
            font-family: var(--font-ui);
            font-size: 0.7rem;
            color: var(--color-text-muted);
            margin-top: 0.25rem;
            letter-spacing: 0.1em;
        }

        .diagram-in { top: 0; left: 50%; transform: translateX(-50%); }
        .diagram-ri { top: 50%; left: 0; transform: translateY(-50%); }
        .diagram-kou { top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .diagram-en { top: 50%; right: 0; transform: translateY(-50%); }
        .diagram-jun { bottom: 0; left: 50%; transform: translateX(-50%); }

        .diagram-lines {
            position: absolute;
            inset: 0;
            pointer-events: none;
        }

        .diagram-lines svg {
            width: 100%;
            height: 100%;
        }

        .diagram-line {
            stroke: var(--color-border);
            stroke-width: 1;
            fill: none;
            stroke-dasharray: 200;
            stroke-dashoffset: 200;
            transition: stroke-dashoffset 1s var(--transition-smooth);
        }

        .diagram-container.animated .diagram-line {
            stroke-dashoffset: 0;
        }

        /* ========== DEFINITION CARDS ========== */
        .definition-grid {
            display: grid;
            gap: 2rem;
        }

        .definition-card {
            background: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            padding: 2.5rem;
            position: relative;
            transition: all 0.4s var(--transition-smooth);
        }

        .definition-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--color-accent);
            transform: scaleY(0);
            transform-origin: top;
            transition: transform 0.4s var(--transition-smooth);
        }

        .definition-header {
            display: flex;
            align-items: baseline;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .definition-kanji {
            font-family: var(--font-display);
            font-size: 2.5rem;
            font-weight: 600;
            color: var(--color-accent);
        }

        .definition-reading {
            font-family: var(--font-ui);
            font-size: 0.85rem;
            color: var(--color-text-muted);
            letter-spacing: 0.1em;
        }

        .definition-meaning {
            font-family: var(--font-display);
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 1rem;
            color: var(--color-text);
        }

        .definition-desc {
            color: var(--color-text-muted);
            line-height: 2;
        }

        .definition-examples {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--color-border);
        }

        .definition-examples-title {
            font-family: var(--font-ui);
            font-size: 0.75rem;
            letter-spacing: 0.2em;
            color: var(--color-text-muted);
            margin-bottom: 0.75rem;
        }

        .definition-examples-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .example-tag {
            font-family: var(--font-ui);
            font-size: 0.8rem;
            padding: 0.25rem 0.75rem;
            background: var(--color-highlight);
            border-radius: 2px;
            color: var(--color-text);
        }

        /* ========== PRINCIPLES ========== */
        .principles-list {
            counter-reset: principle;
        }

        .principle-item {
            padding: 2rem 0;
            border-bottom: 1px solid var(--color-border);
            display: flex;
            gap: 2rem;
            align-items: flex-start;
        }

        .principle-item:last-child {
            border-bottom: none;
        }

        .principle-number {
            font-family: var(--font-display);
            font-size: 2rem;
            font-weight: 300;
            color: var(--color-accent);
            min-width: 3rem;
        }

        .principle-content h3 {
            font-family: var(--font-display);
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .principle-content p {
            color: var(--color-text-muted);
            line-height: 1.9;
        }

        /* ========== CORE QUOTE ========== */
        .core-quote {
            background: var(--color-bg-alt);
            border-left: 4px solid var(--color-accent);
            padding: 3rem;
            margin: 4rem 0;
            position: relative;
        }

        .core-quote::before {
            content: '"';
            position: absolute;
            top: 1rem;
            left: 1.5rem;
            font-family: var(--font-display);
            font-size: 4rem;
            color: var(--color-accent);
            opacity: 0.2;
            line-height: 1;
        }

        .core-quote p {
            font-family: var(--font-display);
            font-size: 1.3rem;
            font-weight: 500;
            line-height: 2;
            position: relative;
            z-index: 1;
        }

        .core-quote p + p {
            margin-top: 0.5rem;
        }

        /* ========== FIELDS SECTION ========== */
        .fields-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid var(--color-border);
            padding-bottom: 1rem;
        }

        .field-tab {
            font-family: var(--font-ui);
            font-size: 0.85rem;
            padding: 0.5rem 1rem;
            border: 1px solid var(--color-border);
            background: transparent;
            color: var(--color-text-muted);
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
        }

        .field-tab:hover,
        .field-tab.active {
            background: var(--color-accent);
            border-color: var(--color-accent);
            color: #fff;
        }

        .field-content {
            display: none;
            animation: fadeIn 0.5s var(--transition-smooth);
        }

        .field-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .field-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
        }

        .field-table th,
        .field-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }

        .field-table th {
            font-family: var(--font-ui);
            font-size: 0.75rem;
            font-weight: 500;
            letter-spacing: 0.1em;
            color: var(--color-text-muted);
            background: var(--color-bg-alt);
        }

        .field-table td:first-child {
            font-family: var(--font-display);
            font-weight: 500;
            color: var(--color-accent);
            width: 80px;
        }

        .field-description {
            color: var(--color-text-muted);
            line-height: 2;
            padding: 1.5rem;
            background: var(--color-highlight);
            border-left: 3px solid var(--color-accent);
        }

        /* ========== FAILURE SECTION ========== */
        .failure-flow {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            padding: 2rem 0;
        }

        .failure-step {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            padding: 1.5rem;
            background: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            position: relative;
            transition: all 0.3s var(--transition-smooth);
        }

        .failure-step::after {
            content: '↓';
            position: absolute;
            bottom: -1.5rem;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.2rem;
            color: var(--color-accent);
        }

        .failure-step:last-child::after {
            display: none;
        }

        .failure-number {
            font-family: var(--font-ui);
            font-size: 0.7rem;
            font-weight: 500;
            letter-spacing: 0.1em;
            color: #fff;
            background: var(--color-accent);
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .failure-text {
            font-family: var(--font-body);
            line-height: 1.7;
        }

        /* ========== FOOTER ========== */
        .footer {
            padding: 6rem 2rem 3rem;
            text-align: center;
            background: var(--color-bg-alt);
            margin-top: 8rem;
        }

        .footer-kanji {
            font-family: var(--font-display);
            font-size: 3rem;
            letter-spacing: 0.5em;
            margin-bottom: 2rem;
            color: var(--color-text-muted);
        }

        .footer-text {
            font-family: var(--font-ui);
            font-size: 0.8rem;
            color: var(--color-text-muted);
            letter-spacing: 0.1em;
            max-width: 500px;
            margin: 0 auto 2rem;
            line-height: 2;
        }

        .footer-copy {
            font-family: var(--font-ui);
            font-size: 0.7rem;
            color: var(--color-text-muted);
            letter-spacing: 0.1em;
        }

        /* ========== HOVER EFFECTS (pointer devices only) ========== */
        @media (hover: hover) {
            .definition-card:hover {
                box-shadow: var(--shadow-medium);
                transform: translateX(8px);
            }

            .definition-card:hover::before {
                transform: scaleY(1);
            }

            .failure-step:hover {
                border-color: var(--color-accent);
                transform: translateX(8px);
            }

            .diagram-element:hover {
                transform: scale(1.1);
            }

            .diagram-element:hover .diagram-kanji {
                color: var(--color-accent);
            }

            .hero-kanji span:hover {
                color: var(--color-accent);
                transform: translateY(-8px);
            }
        }

        /* ========== TABLET (max-width: 1024px) ========== */
        @media (max-width: 1024px) {
            .side-nav {
                left: 1rem;
            }

            .hero-vertical {
                right: 2rem;
                font-size: 0.75rem;
            }

            .main {
                max-width: 800px;
            }

            .section {
                padding: 6rem 0;
            }

            .section-header {
                margin-bottom: 3rem;
            }
        }

        /* ========== MOBILE (max-width: 768px) ========== */
        @media (max-width: 768px) {
            .side-nav {
                display: none;
            }

            .hero-vertical {
                display: none;
            }

            .header {
                padding: 1rem;
            }

            .header.scrolled {
                padding: 0.75rem 1rem;
            }

            .main {
                padding: 0 1.5rem;
            }

            .section {
                padding: 4rem 0;
            }

            .section-header {
                margin-bottom: 2.5rem;
            }

            .section-lead {
                font-size: 1rem;
                line-height: 2;
            }

            .definition-card {
                padding: 1.5rem;
            }

            /* タッチデバイス用：ホバー効果を無効化しアクティブ状態を維持 */
            .definition-card::before {
                transform: scaleY(1);
                opacity: 0.5;
            }

            .principle-item {
                flex-direction: column;
                gap: 1rem;
            }

            .principle-number {
                font-size: 1.5rem;
            }

            .diagram-container {
                width: 280px;
                height: 280px;
            }

            .diagram-kanji {
                font-size: 2rem;
            }

            /* 分野タブ：横スクロール対応 */
            .fields-tabs {
                display: flex;
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                -ms-overflow-style: none;
                gap: 0.5rem;
                padding-bottom: 1rem;
                margin-bottom: 1.5rem;
            }

            .fields-tabs::-webkit-scrollbar {
                display: none;
            }

            .field-tab {
                flex-shrink: 0;
                white-space: nowrap;
                padding: 0.5rem 0.875rem;
                font-size: 0.8rem;
            }

            /* テーブル：横スクロール対応 */
            .field-content {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .field-table {
                min-width: 500px;
            }

            .field-table th,
            .field-table td {
                padding: 0.75rem;
                font-size: 0.9rem;
            }

            .field-description {
                padding: 1rem;
                font-size: 0.9rem;
            }

            .core-quote {
                padding: 2rem 1.5rem;
            }

            .core-quote p {
                font-size: 1.1rem;
            }

            .failure-step {
                padding: 1rem;
                gap: 1rem;
            }

            .failure-text {
                font-size: 0.95rem;
            }

            .footer {
                padding: 4rem 1.5rem 2rem;
                margin-top: 5rem;
            }

            .footer-kanji {
                font-size: 2rem;
                letter-spacing: 0.3em;
            }

            .footer-text {
                font-size: 0.75rem;
            }
        }

        /* ========== SMALL MOBILE (max-width: 480px) ========== */
        @media (max-width: 480px) {
            html {
                font-size: 15px;
            }

            .header {
                padding: 0.875rem 1rem;
            }

            .header-logo {
                font-size: 1.1rem;
                letter-spacing: 0.2em;
            }

            .theme-toggle {
                width: 40px;
                height: 40px;
            }

            .hero {
                padding: 1.5rem;
            }

            .hero-kanji {
                letter-spacing: 0.1em;
                margin-bottom: 1.5rem;
            }

            .hero-tagline {
                font-size: 1rem;
                padding: 0 0.5rem;
            }

            .hero-scroll {
                bottom: 2rem;
            }

            .main {
                padding: 0 1rem;
            }

            .section {
                padding: 3rem 0;
            }

            .section-header {
                margin-bottom: 2rem;
            }

            .section-number {
                font-size: 0.7rem;
            }

            .section-lead {
                font-size: 0.95rem;
                margin-top: 1.5rem;
            }

            .diagram-container {
                width: 240px;
                height: 240px;
            }

            .diagram-kanji {
                font-size: 1.75rem;
            }

            .diagram-label {
                font-size: 0.65rem;
            }

            .definition-card {
                padding: 1.25rem;
            }

            .definition-kanji {
                font-size: 2rem;
            }

            .definition-meaning {
                font-size: 1.1rem;
            }

            .definition-desc {
                font-size: 0.95rem;
            }

            .example-tag {
                font-size: 0.75rem;
                padding: 0.2rem 0.5rem;
            }

            .principle-number {
                font-size: 1.3rem;
                min-width: 2rem;
            }

            .principle-content h3 {
                font-size: 1.05rem;
            }

            .principle-content p {
                font-size: 0.9rem;
            }

            .field-tab {
                padding: 0.4rem 0.75rem;
                font-size: 0.75rem;
            }

            .field-table {
                min-width: 420px;
            }

            .field-table th,
            .field-table td {
                padding: 0.6rem;
                font-size: 0.85rem;
            }

            .field-table td:first-child {
                width: 70px;
            }

            .core-quote {
                padding: 1.5rem 1rem;
                margin: 2.5rem 0;
            }

            .core-quote::before {
                font-size: 3rem;
                top: 0.5rem;
                left: 1rem;
            }

            .core-quote p {
                font-size: 1rem;
            }

            .failure-step {
                padding: 0.875rem;
                gap: 0.875rem;
            }

            .failure-number {
                width: 24px;
                height: 24px;
                font-size: 0.65rem;
            }

            .failure-text {
                font-size: 0.9rem;
            }

            .failure-step::after {
                font-size: 1rem;
                bottom: -1.25rem;
            }

            .footer {
                padding: 3rem 1rem 1.5rem;
                margin-top: 4rem;
            }

            .footer-kanji {
                font-size: 1.5rem;
                letter-spacing: 0.2em;
                margin-bottom: 1.5rem;
            }

            .footer-text {
                font-size: 0.7rem;
                line-height: 1.8;
            }

            .footer-copy {
                font-size: 0.65rem;
            }

            .loading-text {
                font-size: 1.5rem;
                letter-spacing: 0.3em;
            }
        }

        /* ========== LOADING ========== */
        .loading-screen {
            position: fixed;
            inset: 0;
            background: var(--color-bg);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.8s var(--transition-smooth), visibility 0.8s;
        }

        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loading-text {
            font-family: var(--font-display);
            font-size: 2rem;
            letter-spacing: 0.5em;
            animation: loadingPulse 1.5s ease-in-out infinite;
        }

        @keyframes loadingPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loading">
        <div class="loading-text">五式</div>
    </div>

    <!-- Header -->
    <header class="header" id="header">
        <a href="#" class="header-logo">五式</a>
        <div class="header-controls">
            <button class="theme-toggle" id="themeToggle" aria-label="テーマ切替">
                <svg class="moon-icon" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                <svg class="sun-icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3" stroke="currentColor" stroke-width="2"/><line x1="12" y1="21" x2="12" y2="23" stroke="currentColor" stroke-width="2"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64" stroke="currentColor" stroke-width="2"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78" stroke="currentColor" stroke-width="2"/><line x1="1" y1="12" x2="3" y2="12" stroke="currentColor" stroke-width="2"/><line x1="21" y1="12" x2="23" y2="12" stroke="currentColor" stroke-width="2"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36" stroke="currentColor" stroke-width="2"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22" stroke="currentColor" stroke-width="2"/></svg>
            </button>
        </div>
    </header>

    <!-- Side Navigation -->
    <nav class="side-nav" id="sideNav">
        <button class="side-nav-item active" data-section="hero" data-label="序"></button>
        <button class="side-nav-item" data-section="overview" data-label="概要"></button>
        <button class="side-nav-item" data-section="definition" data-label="定義"></button>
        <button class="side-nav-item" data-section="principles" data-label="原則"></button>
        <button class="side-nav-item" data-section="fields" data-label="分野"></button>
        <button class="side-nav-item" data-section="failure" data-label="破綻"></button>
    </nav>

    <!-- Hero -->
    <section class="hero" id="hero">
        <div class="hero-bg"></div>
        <div class="hero-vertical">構造成立と破綻の普遍的アーキテクチャ</div>
        <div class="hero-content">
            <h1 class="hero-kanji">
                <span>因</span><span>理</span><span>縁</span><span>衡</span><span>循</span>
            </h1>
            <p class="hero-subtitle">GOSHIKI</p>
            <p class="hero-tagline">分野を超えて普遍的に適用される、構造の成立条件と破綻条件を示す<br>アーキテクチャ</p>
        </div>
        <div class="hero-scroll">
            <span>SCROLL</span>
            <div class="hero-scroll-line"></div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main">
        <!-- Overview Section -->
        <section class="section" id="overview">
            <div class="section-header">
                <span class="section-number">01 — OVERVIEW</span>
                <h2 class="section-title">全体像</h2>
                <p class="section-lead">
                    五式は思想・倫理・善悪を語るものではなく、構造が成立する条件と破綻する条件を示すアーキテクチャです。身体・社会・物理・宇宙・物語——あらゆる分野に適用可能な、最小限の普遍構造。
                </p>
            </div>

            <div class="goshiki-diagram">
                <div class="diagram-container" id="diagramContainer">
                    <div class="diagram-lines">
                        <svg viewBox="0 0 320 320">
                            <line class="diagram-line" x1="160" y1="50" x2="160" y2="130"/>
                            <line class="diagram-line" x1="50" y1="160" x2="130" y2="160"/>
                            <line class="diagram-line" x1="190" y1="160" x2="270" y2="160"/>
                            <line class="diagram-line" x1="160" y1="190" x2="160" y2="270"/>
                        </svg>
                    </div>
                    <div class="diagram-element diagram-in" data-element="in">
                        <span class="diagram-kanji">因</span>
                        <span class="diagram-label">起点</span>
                    </div>
                    <div class="diagram-element diagram-ri" data-element="ri">
                        <span class="diagram-kanji">理</span>
                        <span class="diagram-label">±</span>
                    </div>
                    <div class="diagram-element diagram-kou" data-element="kou">
                        <span class="diagram-kanji">衡</span>
                        <span class="diagram-label">中核</span>
                    </div>
                    <div class="diagram-element diagram-en" data-element="en">
                        <span class="diagram-kanji">縁</span>
                        <span class="diagram-label">媒介</span>
                    </div>
                    <div class="diagram-element diagram-jun" data-element="jun">
                        <span class="diagram-kanji">循</span>
                        <span class="diagram-label">継承</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Definition Section -->
        <section class="section" id="definition">
            <div class="section-header">
                <span class="section-number">02 — DEFINITION</span>
                <h2 class="section-title">各要素の定義</h2>
            </div>

            <div class="definition-grid">
                <article class="definition-card">
                    <div class="definition-header">
                        <span class="definition-kanji">因</span>
                        <span class="definition-reading">いん / IN</span>
                    </div>
                    <h3 class="definition-meaning">発生・契機・起点</h3>
                    <p class="definition-desc">
                        意図・善悪・正誤は問わない。何かが「起きた」という事実そのもの。因は同時に設計図としての性質を持ち、循環が完了した際にアップデートされて次世代へ継承される。
                    </p>
                </article>

                <article class="definition-card">
                    <div class="definition-header">
                        <span class="definition-kanji">理</span>
                        <span class="definition-reading">ことわり / KOTOWARI</span>
                    </div>
                    <h3 class="definition-meaning">差そのもの</h3>
                    <p class="definition-desc">
                        理（＋）と理（−）の対で存在する。極めて重要なのは、＋と−に上下関係・優劣・善悪は存在しないという点。両者は単に差異を示す記号であり、どちらも「悪くない」。単独でも成立する静的構造。
                    </p>
                    <div class="definition-examples">
                        <div class="definition-examples-title">例</div>
                        <div class="definition-examples-list">
                            <span class="example-tag">男／女</span>
                            <span class="example-tag">左／右</span>
                            <span class="example-tag">供給／需要</span>
                            <span class="example-tag">交感／副交感</span>
                            <span class="example-tag">力／反力</span>
                        </div>
                    </div>
                </article>

                <article class="definition-card">
                    <div class="definition-header">
                        <span class="definition-kanji">縁</span>
                        <span class="definition-reading">えん / EN</span>
                    </div>
                    <h3 class="definition-meaning">理を結ぶ媒介</h3>
                    <p class="definition-desc">
                        理（＋）と理（−）を結ぶ媒介。回路・関係・支点・器官・制度・対話など、具体的形態は分野により異なる。縁は切れる・歪む可能性を内包しており、縁がなければ理はただ並存するのみで相互作用しない。
                    </p>
                </article>

                <article class="definition-card">
                    <div class="definition-header">
                        <span class="definition-kanji">衡</span>
                        <span class="definition-reading">こう / KOU</span>
                    </div>
                    <h3 class="definition-meaning">五式の中核概念</h3>
                    <p class="definition-desc">
                        理（＋）と理（−）が縁によって結ばれた結果として生じる状態。差は消えない。差を保持したまま、揺れながら動的に釣り合っている。静的な「均」や「平」とは本質的に異なり、「共存」よりも強く「相互依存・相互影響」を含む。
                    </p>
                </article>

                <article class="definition-card">
                    <div class="definition-header">
                        <span class="definition-kanji">循</span>
                        <span class="definition-reading">じゅん / JUN</span>
                    </div>
                    <h3 class="definition-meaning">衡の達成と因の更新</h3>
                    <p class="definition-desc">
                        衡のバランスが整ったとき、はじめて循は成立する。その循の収束点（Ω）は次の起点（α）となり、因の設計図は更新されて次の循へと受け渡される。「α₁ → Ω₁ ＝ α₂ → Ω₂ ＝ α₃…」見かけ上回っていても、支配・固定・搾取によって維持されるものは「擬似循」であり、真の循ではない。
                    </p>
                </article>
            </div>
        </section>

        <!-- Principles Section -->
        <section class="section" id="principles">
            <div class="section-header">
                <span class="section-number">03 — PRINCIPLES</span>
                <h2 class="section-title">最重要原則</h2>
            </div>

            <div class="principles-list">
                <div class="principle-item">
                    <span class="principle-number">一</span>
                    <div class="principle-content">
                        <h3>理（＋／−）に上下関係はない</h3>
                        <p>差異は存在するが、それに価値の序列はない。どちらの理も同格であり、どちらも「悪くない」。</p>
                    </div>
                </div>
                <div class="principle-item">
                    <span class="principle-number">二</span>
                    <div class="principle-content">
                        <h3>支配によって循は成立しない</h3>
                        <p>一方が他方を恒常的に抑圧する構造は、見かけ上の循環（擬似循）を生むのみで、真の継承と更新には至らない。</p>
                    </div>
                </div>
                <div class="principle-item">
                    <span class="principle-number">三</span>
                    <div class="principle-content">
                        <h3>循の成立条件は「衡」である</h3>
                        <p>動的平衡なくして持続的循環はない。衡を経ずに回るものは、いずれ破綻する。</p>
                    </div>
                </div>
                <div class="principle-item">
                    <span class="principle-number">四</span>
                    <div class="principle-content">
                        <h3>差別・対立は「衡が理解されなかった結果」</h3>
                        <p>理の問題ではなく、衡の喪失の問題。解決の方向は「差異の消去」ではなく「衡の回復」。</p>
                    </div>
                </div>
                <div class="principle-item">
                    <span class="principle-number">五</span>
                    <div class="principle-content">
                        <h3>悲惨は、衡が偏り戻れなくなったときに生まれる</h3>
                        <p>これは倫理や感情ではなく、構造の帰結である。</p>
                    </div>
                </div>
            </div>

            <div class="core-quote">
                <p>理に上下はない。</p>
                <p>悲惨は、衡が偏り、戻れなくなったときに生まれる。</p>
            </div>
        </section>

        <!-- Fields Section -->
        <section class="section" id="fields">
            <div class="section-header">
                <span class="section-number">04 — APPLICATION</span>
                <h2 class="section-title">分野別適用</h2>
                <p class="section-lead">五式は分野非依存のメタ構造。各分野の専門用語に置換することで適用される。</p>
            </div>

            <div class="fields-tabs" id="fieldsTabs">
                <button class="field-tab active" data-field="immunology">免疫学</button>
                <button class="field-tab" data-field="ecology">生態学</button>
                <button class="field-tab" data-field="thermodynamics">熱力学</button>
                <button class="field-tab" data-field="neuroscience">神経科学</button>
                <button class="field-tab" data-field="endocrinology">内分泌学</button>
                <button class="field-tab" data-field="law">法学</button>
                <button class="field-tab" data-field="finance">金融工学</button>
                <button class="field-tab" data-field="music">音楽理論</button>
                <button class="field-tab" data-field="architecture">建築構造</button>
                <button class="field-tab" data-field="linguistics">言語学</button>
                <button class="field-tab" data-field="biology">発生生物学</button>
                <button class="field-tab" data-field="cosmology">宇宙論</button>
            </div>

            <div id="fieldsContent">
                <div class="field-content active" data-field="immunology">
                    <table class="field-table">
                        <tr><th>五式</th><th>専門用語</th></tr>
                        <tr><td>因</td><td>抗原侵入</td></tr>
                        <tr><td>理<br>＋/−</td><td>炎症促進（Th1）／ 炎症抑制（Th2・Treg）</td></tr>
                        <tr><td>縁</td><td>サイトカインネットワーク</td></tr>
                        <tr><td>衡</td><td>免疫寛容</td></tr>
                        <tr><td>循</td><td>免疫記憶（次世代抗体設計のアップデート）</td></tr>
                    </table>
                    <p class="field-description">Th1もTh2も悪くない。衡（免疫寛容）が偏ると自己免疫疾患やアレルギーが生じる。片側への支配的偏向では恒常性は回復しない。</p>
                </div>

                <div class="field-content" data-field="ecology">
                    <table class="field-table">
                        <tr><th>五式</th><th>専門用語</th></tr>
                        <tr><td>因</td><td>環境撹乱</td></tr>
                        <tr><td>理<br>＋/−</td><td>捕食者 ／ 被食者</td></tr>
                        <tr><td>縁</td><td>食物網</td></tr>
                        <tr><td>衡</td><td>動的平衡（エコロジカル・バランス）</td></tr>
                        <tr><td>循</td><td>遷移（サクセッション）</td></tr>
                    </table>
                    <p class="field-description">捕食者も被食者も生態系において同格。一方の排除は衡を崩壊させ、生態系全体の循環を断つ。</p>
                </div>

                <div class="field-content" data-field="thermodynamics">
                    <table class="field-table">
                        <tr><th>五式</th><th>専門用語</th></tr>
                        <tr><td>因</td><td>エネルギー入力</td></tr>
                        <tr><td>理<br>＋/−</td><td>高温系 ／ 低温系</td></tr>
                        <tr><td>縁</td><td>熱伝導・対流・輻射</td></tr>
                        <tr><td>衡</td><td>熱平衡</td></tr>
                        <tr><td>循</td><td>カルノーサイクル</td></tr>
                    </table>
                    <p class="field-description">高温も低温も物理的に同格。温度差（理）が縁を通じて仕事を生み、サイクルとして循環する。</p>
                </div>

                <div class="field-content" data-field="neuroscience">
                    <table class="field-table">
                        <tr><th>五式</th><th>専門用語</th></tr>
                        <tr><td>因</td><td>シナプス入力</td></tr>
                        <tr><td>理<br>＋/−</td><td>興奮性（EPSP）／ 抑制性（IPSP）</td></tr>
                        <tr><td>縁</td><td>神経回路</td></tr>
                        <tr><td>衡</td><td>E/Iバランス</td></tr>
                        <tr><td>循</td><td>シナプス可塑性（LTP/LTD）</td></tr>
                    </table>
                    <p class="field-description">興奮も抑制も神経機能において必須であり同格。E/Iバランス（衡）の崩壊はてんかんや統合失調症と関連する。</p>
                </div>

                <div class="field-content" data-field="endocrinology">
                    <table class="field-table">
                        <tr><th>五式</th><th>専門用語</th></tr>
                        <tr><td>因</td><td>刺激ホルモン</td></tr>
                        <tr><td>理<br>＋/−</td><td>促進系 ／ 抑制系（フィードバック）</td></tr>
                        <tr><td>縁</td><td>受容体−リガンド結合</td></tr>
                        <tr><td>衡</td><td>ホルモン恒常性</td></tr>
                        <tr><td>循</td><td>負のフィードバックループ</td></tr>
                    </table>
                    <p class="field-description">促進も抑制もホルモン調節に不可欠。負のフィードバック（縁）により衡が維持され、世代を超えて循環する。</p>
                </div>

                <div class="field-content" data-field="law">
                    <table class="field-table">
                        <tr><th>五式</th><th>専門用語</th></tr>
                        <tr><td>因</td><td>紛争・訴因</td></tr>
                        <tr><td>理<br>＋/−</td><td>原告 ／ 被告</td></tr>
                        <tr><td>縁</td><td>司法手続・契約</td></tr>
                        <tr><td>衡</td><td>衡平法（エクイティ）</td></tr>
                        <tr><td>循</td><td>判例更新（法の発展）</td></tr>
                    </table>
                    <p class="field-description">原告も被告も法の前に同格。一方への支配的偏向は司法の信頼を崩壊させ、法の循環的発展を阻害する。</p>
                </div>

                <div class="field-content" data-field="finance">
                    <table class="field-table">
                        <tr><th>五式</th><th>専門用語</th></tr>
                        <tr><td>因</td><td>市場イベント</td></tr>
                        <tr><td>理<br>＋/−</td><td>リスク ／ リターン</td></tr>
                        <tr><td>縁</td><td>ヘッジ手段（デリバティブ）</td></tr>
                        <tr><td>衡</td><td>ポートフォリオ最適化</td></tr>
                        <tr><td>循</td><td>リバランス</td></tr>
                    </table>
                    <p class="field-description">リスクもリターンも投資において同格の要素。リスク回避一辺倒もリターン追求一辺倒も衡を崩し、持続可能な循環を阻害する。</p>
                </div>

                <div class="field-content" data-field="music">
                    <table class="field-table">
                        <tr><th>五式</th><th>専門用語</th></tr>
                        <tr><td>因</td><td>動機（モチーフ）</td></tr>
                        <tr><td>理<br>＋/−</td><td>緊張（ドミナント）／ 解決（トニック）</td></tr>
                        <tr><td>縁</td><td>和声進行</td></tr>
                        <tr><td>衡</td><td>調性均衡</td></tr>
                        <tr><td>循</td><td>変奏・再現（ソナタ形式）</td></tr>
                    </table>
                    <p class="field-description">緊張も解決も音楽において同格。緊張のみ、または解決のみでは音楽的衡は成立せず、形式としての循環も生まれない。</p>
                </div>

                <div class="field-content" data-field="architecture">
                    <table class="field-table">
                        <tr><th>五式</th><th>専門用語</th></tr>
                        <tr><td>因</td><td>荷重</td></tr>
                        <tr><td>理<br>＋/−</td><td>圧縮力 ／ 引張力</td></tr>
                        <tr><td>縁</td><td>接合部・架構</td></tr>
                        <tr><td>衡</td><td>構造平衡</td></tr>
                        <tr><td>循</td><td>耐久設計（ライフサイクル）</td></tr>
                    </table>
                    <p class="field-description">圧縮も引張も構造力学において同格。両者の衡が接合部（縁）を通じて成立することで、建築物は時間に耐え、循環的な更新が可能となる。</p>
                </div>

                <div class="field-content" data-field="linguistics">
                    <table class="field-table">
                        <tr><th>五式</th><th>専門用語</th></tr>
                        <tr><td>因</td><td>発話意図</td></tr>
                        <tr><td>理<br>＋/−</td><td>シニフィアン（記号表現）／ シニフィエ（記号内容）</td></tr>
                        <tr><td>縁</td><td>統語構造</td></tr>
                        <tr><td>衡</td><td>意味の確定（コンテクスト均衡）</td></tr>
                        <tr><td>循</td><td>言語変化（通時的更新）</td></tr>
                    </table>
                    <p class="field-description">記号表現も記号内容も言語において同格。両者の衡がコンテクストを通じて成立し、言語は世代を超えて循環的に更新される。</p>
                </div>

                <div class="field-content" data-field="biology">
                    <table class="field-table">
                        <tr><th>五式</th><th>専門用語</th></tr>
                        <tr><td>因</td><td>受精</td></tr>
                        <tr><td>理<br>＋/−</td><td>形態形成因子（アクチベーター ／ インヒビター）</td></tr>
                        <tr><td>縁</td><td>シグナル伝達経路</td></tr>
                        <tr><td>衡</td><td>パターン形成</td></tr>
                        <tr><td>循</td><td>世代継承（生殖サイクル＋エピジェネティクス更新）</td></tr>
                    </table>
                    <p class="field-description">アクチベーターもインヒビターも発生において同格。両者の衡がパターン形成を可能にし、エピジェネティクスを通じて設計図が更新されながら世代を超えて循環する。</p>
                </div>

                <div class="field-content" data-field="cosmology">
                    <table class="field-table">
                        <tr><th>五式</th><th>専門用語</th></tr>
                        <tr><td>因</td><td>初期揺らぎ（ビッグバン）</td></tr>
                        <tr><td>理<br>＋/−</td><td>重力 ／ 暗黒エネルギー</td></tr>
                        <tr><td>縁</td><td>時空構造</td></tr>
                        <tr><td>衡</td><td>宇宙の臨界密度</td></tr>
                        <tr><td>循</td><td>（仮説）サイクリック宇宙</td></tr>
                    </table>
                    <p class="field-description">重力も暗黒エネルギーも宇宙において同格。両者の衡（臨界密度）が宇宙の運命を決定する。循環的宇宙モデルでは、終焉が次の因となる。</p>
                </div>
            </div>
        </section>

        <!-- Failure Section -->
        <section class="section" id="failure">
            <div class="section-header">
                <span class="section-number">05 — FAILURE</span>
                <h2 class="section-title">破綻構造</h2>
                <p class="section-lead">これは倫理や感情の問題ではなく、構造の失敗である。</p>
            </div>

            <div class="failure-flow">
                <div class="failure-step">
                    <span class="failure-number">1</span>
                    <span class="failure-text">理（＋）を「上」、理（−）を「下」に固定する</span>
                </div>
                <div class="failure-step">
                    <span class="failure-number">2</span>
                    <span class="failure-text">縁が「支配回路」に置き換わる</span>
                </div>
                <div class="failure-step">
                    <span class="failure-number">3</span>
                    <span class="failure-text">衡が成立しなくなる</span>
                </div>
                <div class="failure-step">
                    <span class="failure-number">4</span>
                    <span class="failure-text">見かけの循（擬似循）が生まれる</span>
                </div>
                <div class="failure-step">
                    <span class="failure-number">5</span>
                    <span class="failure-text">世代・身体・文明が壊れる</span>
                </div>
            </div>

            <div class="core-quote" style="margin-top: 3rem;">
                <p>免疫学における自己免疫疾患、生態学における生態系崩壊、社会における権威主義体制、経済における独占——すべて同一の構造的破綻パターンを示す。</p>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-kanji">因理縁衡循</div>
        <p class="footer-text">
            五式は世界を裁くための理論ではなく、支配を正当化する思想でもなく、<br>「なぜ壊れるのか」「なぜ続かないのか」を説明する最小構造である。
        </p>
        <p class="footer-copy">GOSHIKI — Universal Architecture for Structural Integrity</p>
    </footer>

    <script>
        // ========== LOADING ==========
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('loading').classList.add('hidden');
            }, 800);
        });

        // ========== THEME TOGGLE ==========
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;

        // Check for saved theme preference or default to light
        const savedTheme = localStorage.getItem('theme') || 'light';
        html.setAttribute('data-theme', savedTheme);

        themeToggle.addEventListener('click', () => {
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        });

        // ========== HEADER SCROLL ==========
        const header = document.getElementById('header');
        let lastScroll = 0;

        window.addEventListener('scroll', () => {
            const currentScroll = window.pageYOffset;
            
            if (currentScroll > 100) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
            
            lastScroll = currentScroll;
        });

        // ========== SECTION OBSERVER ==========
        const sections = document.querySelectorAll('.section');
        const sideNavItems = document.querySelectorAll('.side-nav-item');

        const observerOptions = {
            root: null,
            rootMargin: '-20% 0px -60% 0px',
            threshold: 0
        };

        const sectionObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    
                    // Update side nav
                    const sectionId = entry.target.id;
                    sideNavItems.forEach(item => {
                        item.classList.remove('active');
                        if (item.dataset.section === sectionId) {
                            item.classList.add('active');
                        }
                    });
                }
            });
        }, observerOptions);

        sections.forEach(section => sectionObserver.observe(section));

        // Hero section is always visible initially
        document.getElementById('hero') && sideNavItems[0].classList.add('active');

        // ========== SIDE NAV CLICK ==========
        sideNavItems.forEach(item => {
            item.addEventListener('click', () => {
                const sectionId = item.dataset.section;
                const section = document.getElementById(sectionId);
                if (section) {
                    section.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // ========== DIAGRAM ANIMATION ==========
        const diagramContainer = document.getElementById('diagramContainer');
        
        const diagramObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animated');
                }
            });
        }, { threshold: 0.5 });

        if (diagramContainer) {
            diagramObserver.observe(diagramContainer);
        }

        // ========== FIELDS TABS ==========
        const fieldsTabs = document.getElementById('fieldsTabs');
        const fieldsContent = document.getElementById('fieldsContent');

        if (fieldsTabs && fieldsContent) {
            fieldsTabs.addEventListener('click', (e) => {
                if (e.target.classList.contains('field-tab')) {
                    // Update tabs
                    document.querySelectorAll('.field-tab').forEach(tab => tab.classList.remove('active'));
                    e.target.classList.add('active');

                    // Update content
                    const field = e.target.dataset.field;
                    document.querySelectorAll('.field-content').forEach(content => {
                        content.classList.remove('active');
                        if (content.dataset.field === field) {
                            content.classList.add('active');
                        }
                    });
                }
            });
        }

        // ========== SMOOTH SCROLL FOR HERO ==========
        document.querySelector('.hero-scroll')?.addEventListener('click', () => {
            document.getElementById('overview')?.scrollIntoView({ behavior: 'smooth' });
        });

        // ========== KANJI HOVER SOUND (Visual feedback) ==========
        document.querySelectorAll('.hero-kanji span').forEach(span => {
            span.addEventListener('mouseenter', () => {
                span.style.transition = 'all 0.15s ease-out';
            });
        });
    </script>
</body>
</html>
