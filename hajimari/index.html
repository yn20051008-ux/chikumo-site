<!DOCTYPE html>

<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç•œç‰©èª - ã‚¹ãƒ†ãƒ¼ã‚¸ãƒãƒƒãƒ—</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

```
body {
  font-family: 'Hiragino Kaku Gothic ProN', 'ãƒ¡ã‚¤ãƒªã‚ª', sans-serif;
  background: linear-gradient(180deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
  color: #fff;
}

h1 {
  font-size: 1.8rem;
  color: #ffb6c1;
  text-shadow: 0 0 10px rgba(255, 182, 193, 0.5);
  margin-bottom: 10px;
  text-align: center;
}

.subtitle {
  font-size: 0.9rem;
  color: #ffd1dc;
  margin-bottom: 30px;
  text-align: center;
}

.map-container {
  position: relative;
  width: 100%;
  max-width: 400px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
}

/* é“ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸é–“ã®ç·šï¼‰ */
.path-line {
  width: 4px;
  height: 40px;
  background: linear-gradient(180deg, #ff69b4, #ff1493);
  border-radius: 2px;
  opacity: 0.3;
  transition: opacity 0.3s;
}

.path-line.active {
  opacity: 1;
  box-shadow: 0 0 10px rgba(255, 105, 180, 0.5);
}

/* ã‚¹ãƒ†ãƒ¼ã‚¸ãƒãƒ¼ãƒ‰ */
.stage-node {
  position: relative;
  width: 120px;
  height: 120px;
  border-radius: 50%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  text-decoration: none;
}

.stage-node.locked {
  background: linear-gradient(145deg, #3a3a5a, #2a2a4a);
  border: 3px dashed #555;
  cursor: not-allowed;
  opacity: 0.6;
}

.stage-node.available {
  background: linear-gradient(145deg, #ff85a2, #ff5c8d);
  border: 4px solid #fff;
  box-shadow: 0 0 20px rgba(255, 105, 180, 0.6);
  animation: pulse 2s infinite;
}

.stage-node.cleared {
  background: linear-gradient(145deg, #87ceeb, #4fc3f7);
  border: 4px solid #fff;
  box-shadow: 0 0 15px rgba(135, 206, 235, 0.5);
}

.stage-node:hover:not(.locked) {
  transform: scale(1.1);
}

@keyframes pulse {
  0%, 100% { box-shadow: 0 0 20px rgba(255, 105, 180, 0.6); }
  50% { box-shadow: 0 0 30px rgba(255, 105, 180, 0.9); }
}

.stage-icon {
  font-size: 2rem;
  margin-bottom: 5px;
}

.stage-name {
  font-size: 0.75rem;
  text-align: center;
  color: #fff;
  font-weight: bold;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
}

.stage-status {
  position: absolute;
  bottom: -8px;
  background: #ffd700;
  color: #333;
  font-size: 0.6rem;
  padding: 2px 8px;
  border-radius: 10px;
  font-weight: bold;
}

.stage-node.locked .stage-status {
  background: #666;
  color: #999;
}

.stage-node.cleared .stage-status {
  background: #90ee90;
  color: #228b22;
}

/* ã‚¹ã‚¿ãƒ¼ãƒˆãƒ»ã‚´ãƒ¼ãƒ«è¡¨ç¤º */
.location-label {
  font-size: 0.8rem;
  color: #ffd1dc;
  padding: 5px 15px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  margin: 10px 0;
}

/* ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ */
.reset-btn {
  margin-top: 40px;
  padding: 10px 20px;
  background: transparent;
  border: 2px solid #ff69b4;
  color: #ff69b4;
  border-radius: 20px;
  cursor: pointer;
  font-size: 0.8rem;
  transition: all 0.3s;
}

.reset-btn:hover {
  background: #ff69b4;
  color: #fff;
}

/* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹è¡¨ç¤º */
.progress-bar {
  width: 100%;
  max-width: 300px;
  height: 20px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 10px;
  margin-top: 30px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #ff69b4, #ff1493);
  border-radius: 10px;
  transition: width 0.5s ease;
}

.progress-text {
  font-size: 0.8rem;
  color: #ffd1dc;
  margin-top: 8px;
}
```

  </style>
</head>
<body>
  <h1>ğŸš€ ç•œç‰©èª ğŸŒŸ</h1>
  <p class="subtitle">ã€œ ç•œæ˜Ÿç·¨ ã€œ</p>

  <div class="location-label">ğŸŒ åœ°çƒï¼ˆå‡ºç™ºåœ°ç‚¹ï¼‰</div>

  <div class="map-container" id="mapContainer">
    <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
  </div>

  <div class="location-label">â­ ç•œæ˜Ÿï¼ˆç›®çš„åœ°ï¼‰</div>

  <div class="progress-bar">
    <div class="progress-fill" id="progressFill"></div>
  </div>
  <p class="progress-text" id="progressText">0 / 5 ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢</p>

<button class="reset-btn" onclick="resetSaveData()">ğŸ”„ ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ</button>

  <script>
    // ==========================================
    // localStorage è¨­å®š
    // ==========================================
    const SAVE_KEY = 'save.map_chikusei_v1';
    const SAVE_VERSION = 1;

    // ã‚¹ãƒ†ãƒ¼ã‚¸å®šç¾©
    const STAGES = [
      { id: 'stage-01', name: 'è»Œé“çªå…¥', icon: 'ğŸ›¸', file: 'stage-01.html' },
      { id: 'stage-02', name: 'å°æƒ‘æ˜Ÿå¸¯', icon: 'â˜„ï¸', file: 'stage-02.html' },
      { id: 'stage-03', name: 'ãƒ‰ãƒƒã‚­ãƒ³ã‚°', icon: 'ğŸ›°ï¸', file: 'stage-03.html' },
      { id: 'stage-04', name: 'å¤§æ°—åœçªå…¥', icon: 'ğŸ”¥', file: 'stage-04.html' },
      { id: 'stage-05', name: 'ç•œæ˜Ÿåˆ°ç€', icon: 'ğŸŒŸ', file: 'stage-05.html' },
    ];

    // ==========================================
    // ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ç®¡ç†
    // ==========================================
    function getDefaultSaveData() {
      const stages = {};
      STAGES.forEach(stage => {
        stages[stage.id] = { cleared: false, clearedAt: null };
      });
      return { version: SAVE_VERSION, stages };
    }

    function loadSaveData() {
      try {
        const raw = localStorage.getItem(SAVE_KEY);
        if (!raw) return getDefaultSaveData();
        
        const data = JSON.parse(raw);
        if (data.version !== SAVE_VERSION) {
          console.log('ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒç•°ãªã‚Šã¾ã™ã€‚ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã€‚');
          return getDefaultSaveData();
        }
        return data;
      } catch (e) {
        console.error('ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:', e);
        return getDefaultSaveData();
      }
    }

    function saveSaveData(data) {
      try {
        localStorage.setItem(SAVE_KEY, JSON.stringify(data));
      } catch (e) {
        console.error('ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—:', e);
      }
    }

    function resetSaveData() {
      if (confirm('æœ¬å½“ã«ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ\nï¼ˆã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ï¼‰')) {
        localStorage.removeItem(SAVE_KEY);
        location.reload();
      }
    }

    // ==========================================
    // ã‚¹ãƒ†ãƒ¼ã‚¸é–‹æ”¾åˆ¤å®š
    // ==========================================
    function isStageUnlocked(stageIndex, saveData) {
      // æœ€åˆã®ã‚¹ãƒ†ãƒ¼ã‚¸ã¯å¸¸ã«é–‹æ”¾
      if (stageIndex === 0) return true;
      
      // å‰ã®ã‚¹ãƒ†ãƒ¼ã‚¸ãŒã‚¯ãƒªã‚¢æ¸ˆã¿ãªã‚‰é–‹æ”¾
      const prevStageId = STAGES[stageIndex - 1].id;
      return saveData.stages[prevStageId]?.cleared === true;
    }

    function isStageCleared(stageId, saveData) {
      return saveData.stages[stageId]?.cleared === true;
    }

    // ==========================================
    // ãƒãƒƒãƒ—æç”»
    // ==========================================
    function renderMap() {
      const saveData = loadSaveData();
      const container = document.getElementById('mapContainer');
      container.innerHTML = '';

      let clearedCount = 0;

      STAGES.forEach((stage, index) => {
        const unlocked = isStageUnlocked(index, saveData);
        const cleared = isStageCleared(stage.id, saveData);

        if (cleared) clearedCount++;

        // ãƒ‘ã‚¹ï¼ˆç·šï¼‰ã‚’è¿½åŠ ï¼ˆæœ€åˆã®ã‚¹ãƒ†ãƒ¼ã‚¸ä»¥å¤–ï¼‰
        if (index > 0) {
          const pathLine = document.createElement('div');
          pathLine.className = 'path-line';
          if (unlocked) pathLine.classList.add('active');
          container.appendChild(pathLine);
        }

        // ã‚¹ãƒ†ãƒ¼ã‚¸ãƒãƒ¼ãƒ‰
        const node = document.createElement('a');
        node.className = 'stage-node';
        
        if (!unlocked) {
          node.classList.add('locked');
          node.href = '#';
          node.onclick = (e) => {
            e.preventDefault();
            alert('ğŸ”’ ã“ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã¯ã¾ã é–‹æ”¾ã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼\nå‰ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã­ï¼');
          };
        } else if (cleared) {
          node.classList.add('cleared');
          node.href = stage.file;
        } else {
          node.classList.add('available');
          node.href = stage.file;
        }

        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ†ã‚­ã‚¹ãƒˆ
        let statusText = '';
        if (!unlocked) {
          statusText = 'ğŸ”’ æœªé–‹æ”¾';
        } else if (cleared) {
          statusText = 'âœ… ã‚¯ãƒªã‚¢æ¸ˆ';
        } else {
          statusText = 'â–¶ æŒ‘æˆ¦å¯èƒ½';
        }

        node.innerHTML = `
          <span class="stage-icon">${stage.icon}</span>
          <span class="stage-name">${stage.name}</span>
          <span class="stage-status">${statusText}</span>
        `;

        container.appendChild(node);
      });

      // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼æ›´æ–°
      const progressFill = document.getElementById('progressFill');
      const progressText = document.getElementById('progressText');
      const percentage = (clearedCount / STAGES.length) * 100;
      progressFill.style.width = percentage + '%';
      progressText.textContent = `${clearedCount} / ${STAGES.length} ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢`;
    }

    // åˆæœŸåŒ–
    document.addEventListener('DOMContentLoaded', renderMap);
  </script>

</body>
</html>