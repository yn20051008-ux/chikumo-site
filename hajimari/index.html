<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç•œç‰©èª - ã‚¹ãƒ†ãƒ¼ã‚¸ãƒãƒƒãƒ—</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700;900&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Zen Maru Gothic', 'Hiragino Kaku Gothic ProN', sans-serif;
      background: #000;
      min-height: 100vh;
      overflow-x: hidden;
      color: #fff;
    }

    /* CanvasèƒŒæ™¯ */
    .cosmos-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
    }

    /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ©ãƒƒãƒ‘ãƒ¼ */
    .content-wrapper {
      position: relative;
      z-index: 10;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
    .header {
      text-align: center;
      padding: 30px 20px 20px;
    }

    .title {
      font-size: 2rem;
      font-weight: 900;
      background: linear-gradient(180deg, #fff7ae 0%, #ffb8d0 50%, #ffa8c8 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      filter: drop-shadow(0 2px 4px rgba(255, 184, 208, 0.5));
      margin-bottom: 5px;
    }

    .subtitle {
      font-size: 1rem;
      color: #ffd1e8;
      font-weight: 500;
      letter-spacing: 0.3em;
    }

    /* ãƒ¡ã‚¤ãƒ³ãƒãƒƒãƒ—ã‚¨ãƒªã‚¢ */
    .map-wrapper {
      flex: 1;
      padding: 20px;
      display: flex;
      justify-content: center;
    }

    .map-container {
      position: relative;
      width: 100%;
      max-width: 400px;
      height: 500px;
    }

    /* æ˜Ÿåº§ã®ç·šï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸é–“ã®æ¥ç¶šï¼‰ */
    .constellation-line {
      position: absolute;
      height: 3px;
      background: linear-gradient(90deg, rgba(255,200,230,0.2), rgba(255,200,230,0.6), rgba(255,200,230,0.2));
      transform-origin: left center;
      border-radius: 2px;
      z-index: 1;
    }

    .constellation-line.active {
      background: linear-gradient(90deg, rgba(255,220,130,0.3), rgba(255,220,130,0.8), rgba(255,220,130,0.3));
      box-shadow: 0 0 10px rgba(255, 220, 130, 0.5);
    }

    /* ã‚¹ãƒ†ãƒ¼ã‚¸ãƒãƒ¼ãƒ‰ï¼ˆæ˜Ÿå‹ï¼‰ */
    .stage-node {
      position: absolute;
      width: 70px;
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      z-index: 10;
    }

    .stage-node:hover {
      transform: scale(1.15);
    }

    .star-shape {
      position: relative;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      filter: drop-shadow(0 0 8px rgba(255, 200, 230, 0.5));
    }

    .star-shape svg {
      width: 100%;
      height: 100%;
      position: absolute;
    }

    .stage-icon {
      position: relative;
      z-index: 2;
      font-size: 1.5rem;
    }

    /* ã‚¹ãƒ†ãƒ¼ã‚¸çŠ¶æ…‹åˆ¥ã‚¹ã‚¿ã‚¤ãƒ« */
    .stage-node.locked .star-shape {
      filter: drop-shadow(0 0 5px rgba(100, 100, 150, 0.3));
      opacity: 0.5;
    }

    .stage-node.locked {
      cursor: not-allowed;
    }

    .stage-node.available .star-shape {
      animation: pulse-glow 2s ease-in-out infinite;
    }

    .stage-node.cleared .star-shape {
      filter: drop-shadow(0 0 12px rgba(255, 230, 150, 0.8));
    }

    @keyframes pulse-glow {
      0%, 100% { filter: drop-shadow(0 0 8px rgba(255, 150, 200, 0.6)); }
      50% { filter: drop-shadow(0 0 20px rgba(255, 150, 200, 1)); }
    }

    /* ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ©ãƒ™ãƒ« */
    .stage-label {
      position: absolute;
      bottom: -25px;
      left: 50%;
      transform: translateX(-50%);
      white-space: nowrap;
      font-size: 0.75rem;
      font-weight: 700;
      color: #fff;
      text-shadow: 0 1px 3px rgba(0,0,0,0.5);
      background: rgba(0,0,0,0.3);
      padding: 3px 8px;
      border-radius: 10px;
    }

    .stage-node.cleared .stage-label {
      background: linear-gradient(135deg, rgba(255,230,150,0.3), rgba(255,200,150,0.3));
    }

    /* ã‚¯ãƒªã‚¢ãƒãƒ¼ã‚¯ */
    .clear-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 24px;
      height: 24px;
      background: linear-gradient(135deg, #ffe66d, #ffb347);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      box-shadow: 0 2px 8px rgba(255, 200, 100, 0.6);
      z-index: 20;
      animation: badge-bounce 2s ease-in-out infinite;
    }

    @keyframes badge-bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    /* ã‚³ãƒƒã‚³ã¡ã‚ƒã‚“ï¼ˆãƒ­ã‚±ãƒƒãƒˆï¼‰ */
    .kokko-rocket {
      position: absolute;
      width: 120px;
      height: 120px;
      z-index: 15;
      transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
      pointer-events: none;
    }

    .rocket-unit {
      position: relative;
      width: 100%;
      height: 100%;
      transform: rotate(-45deg);
      animation: rocket-float 3s ease-in-out infinite;
    }

    .kokko-character {
      width: 40px;
      height: 50px;
      position: absolute;
      top: 5px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 2;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,0.4));
    }

    .rocket-body {
      position: absolute;
      top: 35px;
      left: 50%;
      transform: translateX(-50%);
      width: 35px;
      height: 95px;
    }

    .rocket-body svg {
      width: 100%;
      height: 100%;
      filter: drop-shadow(0 5px 15px rgba(0,0,0,0.4));
    }

    @keyframes rocket-float {
      0%, 100% { transform: rotate(-45deg) translateY(0); }
      50% { transform: rotate(-45deg) translateY(-8px); }
    }

    /* ãƒ­ã‚±ãƒƒãƒˆã®ç‚ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
    .rocket-body .flame {
      animation: flame-flicker 0.15s ease-in-out infinite alternate;
    }

    @keyframes flame-flicker {
      from { opacity: 0.7; transform: scaleY(0.9); }
      to { opacity: 1; transform: scaleY(1.1); }
    }

    /* åœ°çƒãƒ»ç•œæ˜Ÿã‚¢ã‚¤ã‚³ãƒ³ */
    .location-marker {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      z-index: 5;
    }

    .location-icon {
      font-size: 2rem;
      animation: float 4s ease-in-out infinite;
    }

    .location-label {
      font-size: 0.7rem;
      color: #ffd1e8;
      margin-top: 5px;
      background: rgba(0,0,0,0.3);
      padding: 2px 8px;
      border-radius: 8px;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }

    /* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ */
    .progress-section {
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .progress-container {
      width: 100%;
      max-width: 300px;
      background: rgba(255,255,255,0.1);
      border-radius: 20px;
      padding: 15px 20px;
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255,200,230,0.3);
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .progress-title {
      font-size: 0.85rem;
      color: #ffd1e8;
    }

    .progress-count {
      font-size: 1rem;
      font-weight: 700;
      color: #ffe66d;
    }

    .progress-bar {
      width: 100%;
      height: 12px;
      background: rgba(0,0,0,0.3);
      border-radius: 6px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #ff9ec4, #ffb8d0, #ffe66d);
      border-radius: 6px;
      transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
      position: relative;
    }

    .progress-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    /* ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ */
    .reset-btn {
      margin-top: 20px;
      padding: 10px 25px;
      background: transparent;
      border: 2px solid rgba(255,200,230,0.5);
      color: #ffd1e8;
      border-radius: 25px;
      cursor: pointer;
      font-size: 0.8rem;
      font-family: inherit;
      transition: all 0.3s;
    }

    .reset-btn:hover {
      background: rgba(255,200,230,0.2);
      border-color: #ffb8d0;
    }

    /* ã‚­ãƒ©ã‚­ãƒ©ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ« */
    .sparkle {
      position: fixed;
      pointer-events: none;
      animation: sparkle-fade 1s ease-out forwards;
      z-index: 1000;
    }

    @keyframes sparkle-fade {
      0% { transform: scale(0) rotate(0deg); opacity: 1; }
      50% { transform: scale(1) rotate(180deg); opacity: 1; }
      100% { transform: scale(0) rotate(360deg); opacity: 0; }
    }
  </style>
</head>
<body>
  <!-- CanvasèƒŒæ™¯ -->
  <canvas class="cosmos-canvas" id="cosmosCanvas"></canvas>

  <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
  <div class="content-wrapper">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="header">
      <h1 class="title">âœ¨ ç•œç‰©èª âœ¨</h1>
      <p class="subtitle">ã€œ ç•œæ˜Ÿç·¨ ã€œ</p>
    </header>

    <!-- ãƒãƒƒãƒ— -->
    <div class="map-wrapper">
      <div class="map-container" id="mapContainer">
        <!-- åœ°çƒãƒãƒ¼ã‚«ãƒ¼ -->
        <div class="location-marker" style="left: 20px; top: 420px;">
          <span class="location-icon">ğŸŒ</span>
          <span class="location-label">åœ°çƒ</span>
        </div>

        <!-- ç•œæ˜Ÿãƒãƒ¼ã‚«ãƒ¼ -->
        <div class="location-marker" style="right: 20px; top: 20px;">
          <span class="location-icon">â­</span>
          <span class="location-label">ç•œæ˜Ÿ</span>
        </div>

        <!-- ã‚³ãƒƒã‚³ã¡ã‚ƒã‚“ï¼†ãƒ­ã‚±ãƒƒãƒˆ -->
        <div class="kokko-rocket" id="kokkoRocket">
          <div class="rocket-unit">
            <img class="kokko-character" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyOTcuOCAzODkuNCI+PGRlZnM+PHN0eWxlPi5zdDl7ZmlsbDojZmZmfTwvc3R5bGU+PC9kZWZzPjxwYXRoIGQ9Ik0xMjMuMiAzNDcuOWMtMy4yIDctMjMgNC45LTIxLjktMS4yLjUtMi4zIDUuNy0yLjYgOC42LTQuNiAxLjctMS4yLS4yLTUuNiAxLjYtNi4yIDQuNC0xLjYgMTMuNyA3LjUgMTEuNyAxMiIgZmlsbD0iI2RmOTUzYiIvPjxwYXRoIGQ9Ik0xMTIuNiAzNTUuM3EtNC4xIDAtNy41LTEuMWMtNy4yLTIuMy03LTYuNy02LjctOCAuNi0zLjIgMy44LTQuMiA2LjMtNWwzLTEuMnYtMWMwLTEuNi0uMi00LjkgMi44LTYgNC4xLTEuNCA5IDEuOSAxMiA1LjEgMy41IDMuOCA0LjggOCAzLjQgMTEtMiA0LjUtNy43IDYuMi0xMy4zIDYuMlptLTcuOS03LjhjMS4yLjggNC40IDEuOSA4LjYgMS44IDMuNi0uMiA2LjUtMS4yIDcuMS0yLjYuMi0uMyAwLTItMi00LjFhMTMgMTMgMCAwIDAtNC43LTMuN2MwIDEuOCAwIDQuMi0yIDUuN3EtMi42IDEuNS01IDIuMnoiLz48cGF0aCBkPSJNMTk3LjggMzQ2LjdjMy4yIDQuMi0xOCA5LjctMjEuOC45LTEuNy00IDctMTEuMyAxMS4zLTExLjggMy4yIDExIDcuMyA3IDEwLjQgMTEiIGZpbGw9IiNlZGEwM2YiLz48cGF0aCBkPSJNMTg2IDM1NS4zaC0uOHEtOS4yLS40LTEyLTYuNmMtLjUtMS4zLS44LTMuNS45LTYuNSAyLjUtNC4zIDguNy04LjkgMTIuOC05LjRsMi41LS4zLjcgMi40YzEuNyA1LjcgMy4xIDYuMiA1IDYuOCAxLjQuNCAzLjMgMSA1IDMuMmE0IDQgMCAwIDEgLjUgNC44Yy0xLjggMy41LTguOCA1LjYtMTQuNyA1LjZabS0uNi0xNS43Yy0zLjEgMS43LTYuOCA1LjUtNi42IDYuOC44IDEuOCAzIDIuNSA0LjkgMi43IDQgLjYgOC4yLS41IDEwLjMtMS41bC0uOC0uMmMtMi45LTEtNS42LTIuMy03LjgtNy44Wm0xMCA5Ii8+PHBhdGggZD0iTTE5MiA3MC41YzM3IDguMyA2Ny43IDM0IDgxLjEgNjkgNS4zIDEzLjkgNi40IDI5LjUgNS4zIDQ0LjUtMiAzMC0xOS40IDU1LjgtNDYgNjguNy0xNC40IDcgMTIuNiAxMy41IDEzLjYgMzguNC4zIDUuMy0xLjcgMTEtNi44IDExLjYtMy45LjUtMTAuMy0xLjUtMTAuNy02LjFsLTEuMS0xMS44Yy0uMy0yLjQtMi44LTMuNi00LjctMy4xLTEuNS40LTIuOCAyLjUtMi42IDQuNyAxIDE2LjgtNS4zIDM0LTIwLjYgNDIuMi0yNC41IDEzLTcxLjMgMTIuNi05NiAxLjVBNDAgNDAgMCAwIDEgNzkgMjg3LjNjLjQtMi4yLTEuNi00LjctMy4yLTQuNy01LjIgMC00LjYgNy4yLTUuMiAxMi4yLS42IDUuOC01LjcgOC41LTEwLjcgOC0xMy0xLjItOC4zLTI1LjYgMTAtNDEuOSAxLjItMSAyLjEtMi45IDEuOC0zLjlzLS4zLTMuMi0zLTRjLTcuNS0yLTE5LjQtMTItMjUuNi0xNi43LTI3LjktMzItMjkuNy04MS43LTYuNy0xMTcuOEExMDYgMTA2IDAgMCAxIDk2LjEgNzRjNS0xLjQgMTAuOS00LjUgMTUuMy00LjdsNC0yLjJxMzUuNi0zLjcgNzAuOC4yIDMuNi4yIDUuOCAzLjJaIiBmaWxsPSIjZjVlOGM2Ii8+PHBhdGggZD0iTTE1MC44IDM0MS40Yy0xOC40IDAtMzYuNS0zLjItNDguNC04LjZBNDIuNSA0Mi41IDAgMCAxIDc2IDI4N3EwLS43LS42LTEuMy0xLjQuNS0xLjcgNi43IDAgMS42LS4yIDIuOGMtLjggNy44LTcuOCAxMS40LTE0IDEwLjhxLTctLjgtOS4yLTcuNWMtMy40LTEwLjUgNC4zLTI4IDE3LjYtMzkuN3EuNi0uNy44LTEuMmwtLjEtLjNjLS4yLTEtLjMtMS4xLS44LTEuMy03LTItMTcuMi05LjktMjMuOS0xNS4xbC0yLjctMi4xLS4yLS4yLS4yLS4yYy0yOC4zLTMyLjUtMzEuMi04My41LTctMTIxLjQgMTQuMi0yMi4yIDM2LTM4LjQgNjEuNC00NS43bDUuMi0xLjlhNDIgNDIgMCAwIDEgMTAtM2w0LTIgLjctLjFjMjMuNy0yLjUgNDcuNy0yLjUgNzEuMi4ycTQuMS4yIDcuMiAzLjRhMTE1IDExNSAwIDAgMSA4Mi4zIDcwLjdxNy4zIDE5LjMgNS41IDQ1LjdhODUgODUgMCAwIDEtNDcuOCA3MS4yYy0yLjIgMS0yLjUgMS44LTIuNSAxLjggMCAuOSAyLjYgMy44IDQuNCA1LjggNS4xIDUuNyAxMyAxNC4zIDEzLjUgMjggLjQgOC0zLjQgMTQtOS41IDE0LjctMyAuNC03LjUtLjQtMTAuNy0zYTkgOSAwIDAgMS0zLjMtNS44bC0xLjEtMTEuN3EwLS4yLS4zLS41bC0uNS0uMXEtLjUuNC0uNSAxLjZjMS4zIDE5LjgtNy4yIDM3LTIyLjIgNDUtMTMuMSA3LTMxLjggMTAuMi01MC4xIDEwLjJabS03NS02MS44YTYgNiAwIDAgMSA0LjQgMi4zIDggOCAwIDAgMSAxLjggNS45IDM3IDM3IDAgMCAwIDIyLjggMzkuNmMyMi44IDEwLjIgNjguNCAxMS44IDkzLjMtMS41IDE1LjMtOC4yIDE5LjktMjUuNyAxOS0zOS4zLS4yLTMuNiAxLjktNyA0LjgtNy44cTMtLjcgNS42IDFhNyA3IDAgMCAxIDIuOSA0LjhsMSAxMS43cS0uMi40IDEuMiAxLjhhOSA5IDAgMCAwIDYuMiAxLjZjMy42LS40IDQuNC01LjUgNC4yLTguNS0uNS0xMS41LTcuMS0xOC44LTEyLTI0LjItMy42LTQtNi41LTcuMi01LjctMTEgLjYtMy4yIDMuNi01IDUuNy02YTc5IDc5IDAgMCAwIDQ0LjUtNjYuMnExLjctMjUuMS01LjItNDMuMWMtMTIuOS0zNC00Mi40LTU5LTc5LTY3LjJsLTEtLjMtLjYtLjhxLTEuNi0yLTMuNy0yaC0uMmEzMjQgMzI0IDAgMCAwLTY5LjQtLjNsLTQuOCAyLjJhMzQgMzQgMCAwIDAtOSAyLjZxLTIuOCAxLjItNS43IDJjLTI0IDctNDQuNSAyMi4zLTU4IDQzLjItMjIuNyAzNS42LTIwIDgzLjUgNi4zIDExNGwyLjUgMmM2IDQuNiAxNS45IDEyLjQgMjEuOCAxNGE3IDcgMCAwIDEgNSA1LjhsLjEuM2MuNyAyLjQtLjggNS4zLTIuNiA3LTEyLjQgMTEtMTguMyAyNi0xNiAzMy4zcTEgMy4xIDQuMiAzLjRjMy4zLjMgNy0xLjIgNy41LTUuNGwuMi0yLjZjLjMtNC42LjgtMTIuMyA3LjktMTIuM1oiLz48cGF0aCBkPSJtMTkyLjUgNzMuNy0zLS42YTEyNCAxMjQgMCAwIDAtODEuMi0uNGwtLjYtMS44YTQzIDQzIDAgMCAxIDEuNC0zMy43YzQuNS04LjIgMTEuOS0xNCAyMC4zLTE2IDcuMy0xLjYgMTQuNyAwIDIwLjggNC41IDUuMyAzLjggNyAxMSA4LjQgMTYuOS42IDIuNiAxLjcgNyAyLjYgNy40LjcgMCAxLjgtMS41IDIuOC0yLjggMi44LTMuNCA3LTguNyAxNi03LjggNi44LjcgMTIgNS40IDE0LjEgMTIuNmEzMiAzMiAwIDAgMS0xIDIwLjJ6bS0zNi4yLTguMXExNi42LS4yIDMyLjggMi44YTI3IDI3IDAgMCAwIC4yLTE1Yy0xLjUtNS4zLTUtOC41LTkuNy05LTYuNC0uNi05IDIuNy0xMS42IDYtMS45IDIuMi0zLjggNC42LTcgNC42LTQuNi0uMi02LTUuNi03LjMtMTEuMy0xLjMtNS4yLTIuNy0xMS4yLTYuNC0xNHEtNy43LTUuNS0xNi44LTMuNWMtNyAxLjUtMTMuMiA2LjUtMTcgMTMuNC01IDkuNC0zLjggMjAtMS42IDI4bDEzLjItLjhxMTUuNS0xIDMxLjItMS4yIi8+PHBhdGggZD0iTTE4OS42IDczYTMyMyAzMjMgMCAwIDAtNzguMy0uNyA0MSA0MSAwIDAgMSAxLjItMzEuNWM3LjMtMTMuOCAyMy42LTIwLjEgMzYuMi0xMC42IDguMyA2LjIgNi40IDI0LjQgMTIgMjQuNiA0LjkgMCA2LTExLjcgMTguMS0xMC41cTIuMy4zIDQuNCAxLjNjNC42IDIuMiA2LjQgNy4yIDcuMiA5LjRhMjYgMjYgMCAwIDEtLjggMThaIiBmaWxsPSIjZTI2YTNhIi8+PHBhdGggZD0iTTIzNS42IDIxOS42Yy04LjQgMS0xNS43LTMuMi0xOS4yLTkuNS00LTcuMi0yLjctMTUuNiAyLjQtMjEuOCA1LjgtNy4yIDE1LTkuNSAyMy4yLTUuNnMxMyAxMS45IDExLjUgMjAuN2MtMS41IDguNS04IDE1LjEtMTcuOSAxNi4yIiBmaWxsPSIjZWNhNjc4Ii8+PHBhdGggZD0iTTY4IDIxNy42Yy01LjguNi0xMSAwLTE0LjktMi43YTE4IDE4IDAgMCAxLTcuNS0xNC4yYy0uNS05LjYgNi0xOSAxNS41LTIwLjIgMTEuOS0xLjYgMjEgNC41IDIzLjEgMTUuN2ExOC40IDE4LjQgMCAwIDEtMTYuMSAyMS40IiBmaWxsPSIjZWVhYTdkIi8+PHBhdGggZD0iTTE3MS45IDIxMS44Yy00IDguOC0xMy4yIDEyLTIxLjQgMTIuMS04LjguMy0xNy44LTMuMi0yMi4yLTEyLTMuMi02LjMtMy4xLTE2LS4zLTIyLjYgMy44LTguOCAxMy4zLTEyLjEgMjEuOC0xMi42czE4IDQgMjIuMiAxM2EyOSAyOSAwIDAgMS0uMiAyMloiIGZpbGw9IiMxNTI1MjYiLz48cGF0aCBkPSJNMTY0LjkgMTkwLjhjOSAxMC42LTI5LjUgOS0zMC44IDQuOC0uMy0xLjIgMC0zLjIgMS4yLTQuOCA3LjItOS4yIDIyLTguOCAyOS42IDAiIGZpbGw9IiNmM2E0M2QiLz48cGF0aCBkPSJNMTY3IDIwNGMtMS41IDEwLTEwIDEzLjUtMTguOSAxMi42LTcuNS0uNy0xNC40LTMuNy0xNC45LTEyLjcgMTEuMyAzIDIxLjQgMi4xIDMzLjguMSIgZmlsbD0iI2VjOWYzZSIvPjxwYXRoIGQ9Ik0yMTIgMTM0LjVjLTIuNSA0LjMtOC4yLTQuNy0yMS4xLTIuNy0xLjMuMi0zLjQtLjctMy41LTEuNyAwLS45LjMtMi43IDEuNy0zLjcgOS45LTYuNyAyNiAyLjggMjIuOSA4IiBmaWxsPSIjMTgyNjI4Ii8+PHBhdGggZD0iTTExMS4yIDEzMGMuMyA0LjgtNy4yLTEuNy0xOSA1LjEtMS40LjgtMy43LjctNC4yLS41LTIuOC02LjggMTItMTMgMjEuNi04LjUgMS42LjcgMS42IDMgMS42IDMuOSIgZmlsbD0iIzFhMjcyOSIvPjxwYXRoIGQ9Ik0xMTkuNiAxNzkuNWExNyAxNyAwIDAgMS0xNiAxMC44QTE3IDE3IDAgMCAxIDg3LjggMTc5YTE3IDE3IDAgMCAxIDYuNC0xOS4zYzUuOS00LjQgMTQuNC00LjUgMjAtLjFzOC41IDEyLjMgNS4zIDIwIiBmaWxsPSIjMTQyODJiIi8+PHBhdGggZD0iTTE4OC43IDE4OC40Yy04LjctNC42LTEwLjgtMTQuNy03LTIyLjhzMTMuNS0xMS41IDIyLTcuNyAxMS4zIDE0IDcuNyAyMi41LTEzLjggMTIuNi0yMi43IDhaIiBmaWxsPSIjMTQyNzJiIi8+PHBhdGggZD0iTTEwNy4zIDE2Ni4xYzIuMy0xIDQuMi44IDQuNiAyLjMuNSAxLjgtLjIgMy42LTEuOSA0LjMtMS43LjgtMy43LjEtNC40LTEuNHMtLjYtNC4xIDEuNy01LjJNMTk5LjEgMTY2LjNjMi4xLTEuMSA0IC4yIDQuOCAxLjYuOSAxLjcuMiAzLjktMS41IDQuN3MtMy41LjQtNC40LS44Yy0xLjItMS41LTEuMi00LjMgMS4xLTUuNSIgY2xhc3M9InN0OSIvPjwvc3ZnPg==" alt="ã‚³ãƒƒã‚³ã¡ã‚ƒã‚“">
            <div class="rocket-body">
              <svg viewBox="0 0 70 240">
                <defs>
                  <linearGradient id="rocketBody" x1="0%" x2="100%">
                    <stop offset="0%" stop-color="#888"/>
                    <stop offset="50%" stop-color="#f8f8f8"/>
                    <stop offset="100%" stop-color="#888"/>
                  </linearGradient>
                  <linearGradient id="rocketNose" x1="0%" x2="100%">
                    <stop offset="0%" stop-color="#1a1a1a"/>
                    <stop offset="50%" stop-color="#444"/>
                    <stop offset="100%" stop-color="#1a1a1a"/>
                  </linearGradient>
                  <linearGradient id="flameGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" stop-color="#ff3300"/>
                    <stop offset="50%" stop-color="#ffbb00"/>
                    <stop offset="100%" stop-color="rgba(255,255,0,0)"/>
                  </linearGradient>
                  <filter id="flameGlow" x="-100%" y="-20%" width="300%" height="150%">
                    <feGaussianBlur stdDeviation="3"/>
                  </filter>
                </defs>
                <path d="M35,0 C25,15 22,35 22,50 L48,50 C48,35 45,15 35,0 Z" fill="url(#rocketNose)"/>
                <rect x="22" y="50" width="26" height="40" fill="url(#rocketBody)"/>
                <rect x="20" y="90" width="30" height="12" fill="#333"/>
                <rect x="20" y="102" width="30" height="90" fill="url(#rocketBody)"/>
                <rect x="6" y="105" width="12" height="18" fill="#333" rx="1"/>
                <rect x="52" y="105" width="12" height="18" fill="#333" rx="1"/>
                <path d="M20,175 L5,198 L9,200 L22,180" fill="#333"/>
                <path d="M50,175 L65,198 L61,200 L48,180" fill="#333"/>
                <path d="M20,192 L17,202 L53,202 L50,192" fill="#333"/>
                <g class="flame">
                  <ellipse cx="35" cy="255" rx="32" ry="45" fill="url(#flameGrad)" filter="url(#flameGlow)" opacity="0.5"/>
                  <path d="M24,208 Q18,235 15,270 Q26,305 35,315 Q44,305 55,270 Q52,235 46,208 Z" fill="url(#flameGrad)" filter="url(#flameGlow)"/>
                </g>
              </svg>
            </div>
          </div>
        </div>

        <!-- ã‚¹ãƒ†ãƒ¼ã‚¸ãƒãƒ¼ãƒ‰ã¯JSã§ç”Ÿæˆ -->
      </div>
    </div>

    <!-- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ -->
    <div class="progress-section">
      <div class="progress-container">
        <div class="progress-header">
          <span class="progress-title">ğŸš€ æ—…ã®é€²ã¿å…·åˆ</span>
          <span class="progress-count" id="progressCount">0 / 5</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
      </div>
      <button class="reset-btn" onclick="resetSaveData()">ğŸ”„ ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
    </div>
  </div>

  <script>
    // ==========================================
    // Canvaså®‡å®™èƒŒæ™¯
    // ==========================================
    (function() {
      const canvas = document.getElementById('cosmosCanvas');
      const ctx = canvas.getContext('2d');
      let w = canvas.width = window.innerWidth;
      let h = canvas.height = window.innerHeight;
      let frame = 0;
      let mouse = { x: 0.5, y: 0.5 };

      // æ˜Ÿã‚¯ãƒ©ã‚¹
      class Star {
        constructor() { this.reset(); }
        reset() {
          this.x = Math.random() * w;
          this.y = Math.random() * h;
          this.z = Math.random();
          this.baseRadius = 0.3 + Math.random() * 2.5;
          this.twinkleSpeed = 0.015 + Math.random() * 0.035;
          this.twinkleOffset = Math.random() * Math.PI * 2;
          this.drawX = this.x;
          this.drawY = this.y;
          const temp = Math.random();
          if (temp > 0.92) { this.hue = Math.random() * 30; this.sat = 80; }
          else if (temp > 0.85) { this.hue = 30 + Math.random() * 30; this.sat = 70; }
          else if (temp > 0.6) { this.hue = 45 + Math.random() * 15; this.sat = 40; }
          else if (temp > 0.3) { this.hue = 60; this.sat = 10; }
          else { this.hue = 200 + Math.random() * 40; this.sat = 60; }
        }
        update(t, mouse) {
          this.twinkle = (Math.sin(t * this.twinkleSpeed + this.twinkleOffset) + 1) / 2;
          const parallax = (1 - this.z) * 30;
          this.drawX = this.x + (mouse.x - 0.5) * parallax;
          this.drawY = this.y + (mouse.y - 0.5) * parallax;
        }
        draw(ctx) {
          const r = this.baseRadius * (0.5 + this.z * 0.5) * (0.7 + this.twinkle * 0.3);
          const alpha = (0.3 + this.z * 0.7) * (0.5 + this.twinkle * 0.5);
          ctx.beginPath();
          ctx.arc(this.drawX, this.drawY, r, 0, Math.PI * 2);
          ctx.fillStyle = `hsla(${this.hue}, ${this.sat}%, 95%, ${alpha})`;
          ctx.fill();
          const glow = ctx.createRadialGradient(this.drawX, this.drawY, 0, this.drawX, this.drawY, r * 6);
          glow.addColorStop(0, `hsla(${this.hue}, ${this.sat}%, 80%, ${alpha * 0.4})`);
          glow.addColorStop(0.5, `hsla(${this.hue}, ${this.sat}%, 60%, ${alpha * 0.1})`);
          glow.addColorStop(1, 'transparent');
          ctx.beginPath();
          ctx.arc(this.drawX, this.drawY, r * 6, 0, Math.PI * 2);
          ctx.fillStyle = glow;
          ctx.fill();
          if (this.baseRadius > 1.8 && this.twinkle > 0.6) {
            ctx.strokeStyle = `hsla(${this.hue}, ${this.sat}%, 90%, ${alpha * 0.3})`;
            ctx.lineWidth = 0.5;
            ctx.beginPath();
            ctx.moveTo(this.drawX - r * 4, this.drawY);
            ctx.lineTo(this.drawX + r * 4, this.drawY);
            ctx.moveTo(this.drawX, this.drawY - r * 4);
            ctx.lineTo(this.drawX, this.drawY + r * 4);
            ctx.stroke();
          }
        }
      }

      // æ˜Ÿé›²ã‚¯ãƒ©ã‚¹
      class Nebula {
        constructor() {
          this.x = Math.random() * w;
          this.y = Math.random() * h;
          this.radius = 150 + Math.random() * 250;
          this.hue = Math.random() * 360;
          this.rotation = Math.random() * Math.PI * 2;
          this.rotSpeed = (Math.random() - 0.5) * 0.0005;
        }
        update() { this.rotation += this.rotSpeed; }
        draw(ctx) {
          ctx.save();
          ctx.translate(this.x, this.y);
          ctx.rotate(this.rotation);
          for (let i = 0; i < 3; i++) {
            const grad = ctx.createRadialGradient(i * 20 - 20, i * 10 - 10, 0, 0, 0, this.radius * (0.8 + i * 0.2));
            const hue = (this.hue + i * 40) % 360;
            grad.addColorStop(0, `hsla(${hue}, 70%, 50%, 0.04)`);
            grad.addColorStop(0.4, `hsla(${hue}, 60%, 40%, 0.02)`);
            grad.addColorStop(1, 'transparent');
            ctx.beginPath();
            ctx.ellipse(0, 0, this.radius * (1 + i * 0.3), this.radius * 0.5 * (1 + i * 0.2), i * 0.3, 0, Math.PI * 2);
            ctx.fillStyle = grad;
            ctx.fill();
          }
          ctx.restore();
        }
      }

      // éŠ€æ²³ã‚¯ãƒ©ã‚¹
      class Galaxy {
        constructor(x, y, size) {
          this.x = x; this.y = y; this.size = size;
          this.rotation = Math.random() * Math.PI * 2;
          this.rotSpeed = 0.0008;
          this.arms = 2 + Math.floor(Math.random() * 3);
          this.hue = Math.random() * 60 + 200;
          this.particles = [];
          for (let i = 0; i < 800; i++) {
            const arm = i % this.arms;
            const dist = Math.pow(Math.random(), 0.5) * this.size;
            const armAngle = (arm / this.arms) * Math.PI * 2;
            const spiral = dist * 0.015;
            const spread = (Math.random() - 0.5) * 0.5 * (dist / this.size);
            this.particles.push({ dist, angle: armAngle + spiral + spread, size: 0.3 + Math.random() * 1.2, bright: Math.random() });
          }
        }
        update() { this.rotation += this.rotSpeed; }
        draw(ctx) {
          ctx.save();
          ctx.translate(this.x, this.y);
          ctx.rotate(this.rotation);
          const core = ctx.createRadialGradient(0, 0, 0, 0, 0, this.size * 0.3);
          core.addColorStop(0, `hsla(${this.hue + 40}, 40%, 90%, 0.3)`);
          core.addColorStop(0.3, `hsla(${this.hue + 20}, 50%, 60%, 0.1)`);
          core.addColorStop(1, 'transparent');
          ctx.beginPath();
          ctx.arc(0, 0, this.size * 0.3, 0, Math.PI * 2);
          ctx.fillStyle = core;
          ctx.fill();
          this.particles.forEach(p => {
            const x = Math.cos(p.angle) * p.dist;
            const y = Math.sin(p.angle) * p.dist * 0.4;
            const fade = 1 - (p.dist / this.size) * 0.7;
            ctx.beginPath();
            ctx.arc(x, y, p.size * fade, 0, Math.PI * 2);
            ctx.fillStyle = `hsla(${this.hue + p.bright * 60}, ${30 + p.bright * 40}%, ${70 + p.bright * 25}%, ${fade * 0.6})`;
            ctx.fill();
          });
          ctx.restore();
        }
      }

      // ã‚ªãƒ¼ãƒ­ãƒ©ã‚¯ãƒ©ã‚¹
      class Aurora {
        constructor() {
          this.waves = [];
          for (let i = 0; i < 5; i++) {
            this.waves.push({
              y: h * 0.1 + i * 30,
              amplitude: 20 + Math.random() * 40,
              frequency: 0.002 + Math.random() * 0.003,
              speed: 0.01 + Math.random() * 0.02,
              phase: Math.random() * Math.PI * 2,
              hue: 140 + i * 20,
              alpha: 0.03 - i * 0.005
            });
          }
        }
        update() { this.waves.forEach(wave => { wave.phase += wave.speed; }); }
        draw(ctx) {
          this.waves.forEach(wave => {
            ctx.beginPath();
            ctx.moveTo(0, wave.y);
            for (let x = 0; x <= w; x += 5) {
              const y = wave.y + Math.sin(x * wave.frequency + wave.phase) * wave.amplitude;
              ctx.lineTo(x, y);
            }
            ctx.lineTo(w, h * 0.4);
            ctx.lineTo(0, h * 0.4);
            ctx.closePath();
            const grad = ctx.createLinearGradient(0, wave.y - wave.amplitude, 0, h * 0.4);
            grad.addColorStop(0, `hsla(${wave.hue}, 80%, 60%, ${wave.alpha})`);
            grad.addColorStop(0.5, `hsla(${wave.hue + 30}, 70%, 50%, ${wave.alpha * 0.5})`);
            grad.addColorStop(1, 'transparent');
            ctx.fillStyle = grad;
            ctx.fill();
          });
        }
      }

      // åˆæœŸåŒ–
      const stars = [];
      for (let i = 0; i < 600; i++) stars.push(new Star());
      const nebulae = [];
      for (let i = 0; i < 3; i++) nebulae.push(new Nebula());
      const galaxy = new Galaxy(w * 0.75, h * 0.35, 180);
      const aurora = new Aurora();

      // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—
      function animate() {
        frame++;
        const bg = ctx.createRadialGradient(w * 0.3, h * 0.3, 0, w / 2, h / 2, Math.max(w, h));
        bg.addColorStop(0, '#0d0d1a');
        bg.addColorStop(0.5, '#070711');
        bg.addColorStop(1, '#020204');
        ctx.fillStyle = bg;
        ctx.fillRect(0, 0, w, h);

        aurora.update();
        aurora.draw(ctx);
        nebulae.forEach(n => { n.update(); n.draw(ctx); });
        galaxy.update();
        galaxy.draw(ctx);
        stars.forEach(s => { s.update(frame, mouse); s.draw(ctx); });

        // ãƒ“ãƒãƒƒãƒˆåŠ¹æœ
        const vignette = ctx.createRadialGradient(w / 2, h / 2, h * 0.3, w / 2, h / 2, Math.max(w, h) * 0.8);
        vignette.addColorStop(0, 'transparent');
        vignette.addColorStop(1, 'rgba(0, 0, 0, 0.4)');
        ctx.fillStyle = vignette;
        ctx.fillRect(0, 0, w, h);

        requestAnimationFrame(animate);
      }

      // ã‚¤ãƒ™ãƒ³ãƒˆ
      window.addEventListener('mousemove', (e) => {
        mouse.x = e.clientX / w;
        mouse.y = e.clientY / h;
      });
      window.addEventListener('resize', () => {
        w = canvas.width = window.innerWidth;
        h = canvas.height = window.innerHeight;
        stars.forEach(s => s.reset());
      });

      animate();
    })();

    // ==========================================
    // localStorage è¨­å®š
    // ==========================================
    const SAVE_KEY = 'save.map_chikusei_v1';
    const SAVE_VERSION = 1;

    // ã‚¹ãƒ†ãƒ¼ã‚¸å®šç¾©ï¼ˆæ˜Ÿåº§é…ç½®ï¼‰
    const STAGES = [
      { id: 'stage-01', name: 'è»Œé“çªå…¥', icon: 'ğŸ›¸', file: 'stage-01.html', x: 60, y: 380 },
      { id: 'stage-02', name: 'å°æƒ‘æ˜Ÿå¸¯', icon: 'â˜„ï¸', file: 'stage-02.html', x: 180, y: 320 },
      { id: 'stage-03', name: 'ãƒ‰ãƒƒã‚­ãƒ³ã‚°', icon: 'ğŸ›°ï¸', file: 'stage-03.html', x: 280, y: 230 },
      { id: 'stage-04', name: 'å¤§æ°—åœçªå…¥', icon: 'ğŸ”¥', file: 'stage-04.html', x: 140, y: 150 },
      { id: 'stage-05', name: 'ç•œæ˜Ÿåˆ°ç€', icon: 'ğŸŒŸ', file: 'stage-05.html', x: 260, y: 60 },
    ];

    // ==========================================
    // ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ç®¡ç†
    // ==========================================
    function getDefaultSaveData() {
      const stages = {};
      STAGES.forEach(s => { stages[s.id] = { cleared: false, clearedAt: null }; });
      return { version: SAVE_VERSION, stages };
    }

    function loadSaveData() {
      try {
        const raw = localStorage.getItem(SAVE_KEY);
        if (!raw) return getDefaultSaveData();
        const data = JSON.parse(raw);
        if (data.version !== SAVE_VERSION) return getDefaultSaveData();
        return data;
      } catch (e) {
        return getDefaultSaveData();
      }
    }

    function resetSaveData() {
      if (confirm('ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
        localStorage.removeItem(SAVE_KEY);
        location.reload();
      }
    }

    // ==========================================
    // ã‚¹ãƒ†ãƒ¼ã‚¸åˆ¤å®š
    // ==========================================
    function isStageUnlocked(idx, saveData) {
      if (idx === 0) return true;
      return saveData.stages[STAGES[idx - 1].id]?.cleared === true;
    }

    function isStageCleared(id, saveData) {
      return saveData.stages[id]?.cleared === true;
    }

    // ==========================================
    // æ˜Ÿåº§ã®ç·šã‚’æç”»
    // ==========================================
    function drawConstellationLines(saveData) {
      const container = document.getElementById('mapContainer');
      for (let i = 0; i < STAGES.length - 1; i++) {
        const from = STAGES[i];
        const to = STAGES[i + 1];
        const unlocked = isStageUnlocked(i + 1, saveData);
        const dx = to.x - from.x;
        const dy = to.y - from.y;
        const length = Math.sqrt(dx * dx + dy * dy);
        const angle = Math.atan2(dy, dx) * 180 / Math.PI;
        const line = document.createElement('div');
        line.className = 'constellation-line' + (unlocked ? ' active' : '');
        line.style.width = length + 'px';
        line.style.left = (from.x + 35) + 'px';
        line.style.top = (from.y + 35) + 'px';
        line.style.transform = `rotate(${angle}deg)`;
        container.appendChild(line);
      }
    }

    // ==========================================
    // ãƒãƒƒãƒ—æç”»
    // ==========================================
    function renderMap() {
      const saveData = loadSaveData();
      const container = document.getElementById('mapContainer');
      container.querySelectorAll('.stage-node, .constellation-line').forEach(el => el.remove());
      drawConstellationLines(saveData);

      let clearedCount = 0;
      let currentStageIndex = 0;

      STAGES.forEach((stage, index) => {
        const unlocked = isStageUnlocked(index, saveData);
        const cleared = isStageCleared(stage.id, saveData);
        if (cleared) { clearedCount++; currentStageIndex = index + 1; }
        else if (unlocked && currentStageIndex === index) { currentStageIndex = index; }

        const node = document.createElement('a');
        node.className = 'stage-node';
        node.style.left = stage.x + 'px';
        node.style.top = stage.y + 'px';

        let starColor, strokeColor;
        if (!unlocked) {
          node.classList.add('locked');
          starColor = '#4a4a6a';
          strokeColor = '#3a3a5a';
          node.href = '#';
          node.onclick = (e) => { e.preventDefault(); alert('ğŸ”’ ã¾ã é–‹æ”¾ã•ã‚Œã¦ã„ãªã„ã‚ˆï¼\nå‰ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã­ï¼'); };
        } else if (cleared) {
          node.classList.add('cleared');
          starColor = 'url(#clearedGrad)';
          strokeColor = '#ffe66d';
          node.href = stage.file;
        } else {
          node.classList.add('available');
          starColor = 'url(#availableGrad)';
          strokeColor = '#ffb8d0';
          node.href = stage.file;
        }

        const starSVG = `<svg viewBox="0 0 100 100">
          <defs>
            <linearGradient id="clearedGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#ffe66d"/>
              <stop offset="100%" style="stop-color:#ffb347"/>
            </linearGradient>
            <linearGradient id="availableGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#ffb8d0"/>
              <stop offset="100%" style="stop-color:#ff9ec4"/>
            </linearGradient>
          </defs>
          <polygon points="50,8 61,35 92,35 67,54 76,85 50,68 24,85 33,54 8,35 39,35"
            fill="${starColor}" stroke="${strokeColor}" stroke-width="2"/>
        </svg>`;

        node.innerHTML = `
          <div class="star-shape">${starSVG}<span class="stage-icon">${stage.icon}</span></div>
          <span class="stage-label">${stage.name}</span>
          ${cleared ? '<div class="clear-badge">âœ“</div>' : ''}
        `;

        node.addEventListener('click', (e) => {
          if (!node.classList.contains('locked')) createSparkles(e.clientX, e.clientY);
        });

        container.appendChild(node);
      });

      updateKokkoPosition(currentStageIndex);
      document.getElementById('progressCount').textContent = `${clearedCount} / ${STAGES.length}`;
      document.getElementById('progressFill').style.width = (clearedCount / STAGES.length * 100) + '%';
    }

    // ==========================================
    // ã‚³ãƒƒã‚³ã¡ã‚ƒã‚“ä½ç½®æ›´æ–°
    // ==========================================
    function updateKokkoPosition(stageIndex) {
      const kokko = document.getElementById('kokkoRocket');
      const stage = STAGES[Math.min(stageIndex, STAGES.length - 1)];
      kokko.style.left = (stage.x - 5) + 'px';
      kokko.style.top = (stage.y - 95) + 'px';
    }

    // ==========================================
    // ã‚­ãƒ©ã‚­ãƒ©ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
    // ==========================================
    function createSparkles(x, y) {
      const colors = ['#ffe66d', '#ffb8d0', '#87ceeb', '#fff'];
      for (let i = 0; i < 8; i++) {
        const sparkle = document.createElement('div');
        sparkle.className = 'sparkle';
        sparkle.innerHTML = 'âœ¦';
        sparkle.style.left = x + (Math.random() - 0.5) * 60 + 'px';
        sparkle.style.top = y + (Math.random() - 0.5) * 60 + 'px';
        sparkle.style.color = colors[Math.floor(Math.random() * colors.length)];
        sparkle.style.fontSize = (Math.random() * 15 + 10) + 'px';
        document.body.appendChild(sparkle);
        setTimeout(() => sparkle.remove(), 1000);
      }
    }

    // ==========================================
    // åˆæœŸåŒ–
    // ==========================================
    document.addEventListener('DOMContentLoaded', renderMap);
  </script>
</body>
</html>
